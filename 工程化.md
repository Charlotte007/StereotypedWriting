## ğŸ˜Š å¦‚ä½•æ£€æµ‹é¡µé¢çš„å´©æºƒï¼Ÿ
> å‚è€ƒæ–‡ç« -- [å¦‚ä½•ç›‘æ§ç½‘é¡µå´©æºƒï¼Ÿ](https://zhuanlan.zhihu.com/p/40273861)
### æœ¬åœ°å­˜å‚¨çš„æ–¹æ³•

åœ¨é¡µé¢åŠ è½½æ—¶ï¼ˆload äº‹ä»¶ï¼‰åœ¨ `sessionStorage` è®°å½• good_exit çŠ¶æ€ä¸º pendingï¼Œå¦‚æœç”¨æˆ·æ­£å¸¸é€€å‡ºï¼ˆbeforeunload äº‹ä»¶ï¼‰çŠ¶æ€æ”¹ä¸º trueï¼Œå¦‚æœ crash äº†ï¼ŒçŠ¶æ€ä¾ç„¶ä¸º pendingï¼Œåœ¨ç”¨æˆ·ç¬¬2æ¬¡è®¿é—®ç½‘é¡µçš„æ—¶å€™ï¼ˆç¬¬2ä¸ªloadäº‹ä»¶ï¼‰ï¼ŒæŸ¥çœ‹ good_exit çš„çŠ¶æ€ï¼Œå¦‚æœä»ç„¶æ˜¯ pending å°±æ˜¯å¯ä»¥æ–­å®šä¸Šæ¬¡è®¿é—®ç½‘é¡µå´©æºƒäº†ã€‚

å­˜åœ¨çš„é—®é¢˜ï¼š

1. é‡‡ç”¨ sessionStorage å­˜å‚¨çŠ¶æ€ï¼Œä½†é€šå¸¸ç½‘é¡µå´©æºƒ/å¡æ­»åï¼Œç”¨æˆ·ä¼šå¼ºåˆ¶å…³é—­ç½‘é¡µæˆ–è€…ç´¢æ€§é‡æ–°æ‰“å¼€æµè§ˆå™¨ï¼ŒsessionStorage å­˜å‚¨ä½†çŠ¶æ€å°†ä¸å¤å­˜åœ¨ï¼›
2. å¦‚æœå°†çŠ¶æ€å­˜å‚¨åœ¨ localStorage ç”šè‡³ Cookie ä¸­ï¼Œå¦‚æœç”¨æˆ·å…ˆåæ‰“å¼€å¤šä¸ªç½‘é¡µï¼Œä½†ä¸å…³é—­ï¼Œgood_exit å­˜å‚¨çš„ä¸€ç›´éƒ½æ˜¯ pendingï¼Œå®Œäº†ï¼Œæ¯æœ‰ä¸€æ¬¡ç½‘é¡µæ‰“å¼€ï¼Œå°±ä¼šæœ‰ä¸€ä¸ª crash ä¸ŠæŠ¥ã€‚

### Service Worker 

- p1ï¼šç½‘é¡µåŠ è½½åï¼Œé€šè¿‡ postMessage API æ¯ 5s ç»™ sw å‘é€ä¸€ä¸ªå¿ƒè·³ï¼Œè¡¨ç¤ºè‡ªå·±çš„åœ¨çº¿ï¼Œsw å°†åœ¨çº¿çš„ç½‘é¡µç™»è®°ä¸‹æ¥ï¼Œæ›´æ–°ç™»è®°æ—¶é—´ï¼›
- p2ï¼šç½‘é¡µåœ¨ `beforeunload` æ—¶ï¼Œé€šè¿‡ postMessage API å‘ŠçŸ¥è‡ªå·±å·²ç»æ­£å¸¸å…³é—­ï¼Œsw å°†ç™»è®°çš„ç½‘é¡µæ¸…é™¤ï¼›
- p3ï¼šå¦‚æœç½‘é¡µåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ crash äº†ï¼Œsw ä¸­çš„ running çŠ¶æ€å°†ä¸ä¼šè¢«æ¸…é™¤ï¼Œæ›´æ–°æ—¶é—´åœç•™åœ¨å¥”æºƒå‰çš„æœ€åä¸€æ¬¡å¿ƒè·³ï¼›
- swï¼šService Worker æ¯ 10s æŸ¥çœ‹ä¸€éç™»è®°ä¸­çš„ç½‘é¡µï¼Œå‘ç°ç™»è®°æ—¶é—´å·²ç»è¶…å‡ºäº†ä¸€å®šæ—¶é—´ï¼ˆæ¯”å¦‚ 15sï¼‰å³å¯åˆ¤å®šè¯¥ç½‘é¡µ crash äº†ã€‚

## ğŸ˜Š è¯´ä¸€è¯´å‰ç«¯å¼‚å¸¸å¦‚ä½•ç›‘æ§

### é”™è¯¯çš„æ•è·çš„æ–¹å¼

- `onerror`, `onerror`å¯ä»¥æ•è·åˆ°`å®ä»»åŠ¡`æŠ›å‡ºçš„é”™è¯¯ã€‚è€Œ`Promise`å’Œ`async`å‡½æ•°æŠ›å‡ºçš„é”™è¯¯æ˜¯æ•è·ä¸åˆ°çš„ã€‚
- `window.addEventListener('error', () => {}, true)`, ç”±äº`èµ„æºè¯·æ±‚å¼‚å¸¸`ä¸ä¼šå†’æ³¡ï¼Œåªæœ‰åœ¨æ•è·é˜¶æ®µæ‰èƒ½è·å–åˆ°ã€‚å¯ä»¥ä½¿ç”¨`window.addEventListener`è®¾ç½®ä¸ºæ•è·é˜¶æ®µè§¦å‘ï¼Œç”¨æ¥æ•è·èµ„æºè¯·æ±‚çš„é”™è¯¯ã€‚ï¼ˆéœ€è¦æ³¨æ„åˆ¤æ–­event.target, é¿å…å’Œ`onerror`é‡å¤ç›‘å¬ï¼‰
- `onunhandledrejection`, `onunhandledrejection`å¯ä»¥æ•è·`å¾®ä»»åŠ¡`ä¸­çš„é”™è¯¯ã€‚ä½†æ˜¯`æ²¡æœ‰é”™è¯¯è¡Œå’Œåˆ—ç­‰ä½ç½®ä¿¡æ¯`ã€‚ï¼ˆä¸æ¨èç›´æ¥ä½¿ç”¨ï¼Œå»ºè®®è‡ªå·±ä¸»åŠ¨ä¸ŠæŠ¥ï¼Œå¯ä»¥å¯¹è¯·æ±‚åº“è¿›è¡Œå°è£…ï¼Œå‘ç”Ÿé”™è¯¯æ—¶è‡ªåŠ¨ä¸ŠæŠ¥ï¼‰ã€‚
- `tryâ€¦catch`,  `æ— æ³•æ•è·åˆ°å¼‚æ­¥ä¸­çš„é”™è¯¯`(å¾®ä»»åŠ¡, ä»¥åŠ`setTimeout`)ä¸­çš„é”™è¯¯ã€‚å¹¶ä¸”`tryâ€¦catch`ä¹Ÿæ— æ³•æ•è·è¯­æ³•é”™è¯¯ã€‚

#### Reactä¸ŠæŠ¥

Reactå¯ä»¥ä½¿ç”¨**é”™è¯¯è¾¹ç•Œ**ç»„ä»¶å¯¹UIåšé™çº§å¤„ç†ã€‚ä½¿ç”¨`static getDerivedStateFromError()`é™çº§UIã€‚`componentDidCatch`ç”¨äºä¸ŠæŠ¥é”™è¯¯ã€‚
#### ä¸€äº›å¸¸è§çš„é—®é¢˜

- Script errorã€‚å¯¹äºæœ¬åŸŸçš„jsæŠ›å‡ºçš„é”™è¯¯ï¼ŒonerroråŒ…å«äº†è¯¦æƒ…çš„é”™è¯¯ä¿¡æ¯ã€‚å¯¹äºå…¶ä»–åŸŸçš„jsæŠ›å‡ºçš„é”™è¯¯ï¼Œåªä¼šåœ¨msgä¸­æ˜¾ç¤ºç®€å•çš„ Script errorã€‚å¯ä»¥åœ¨scriptæ ‡ç­¾ä¸Šæ·»åŠ ï¼Œcrossoriginå±æ€§ï¼Œé™æ€æ–‡ä»¶æœåŠ¡å™¨å¼€å¯CORSã€‚

### é”™è¯¯ä¿¡æ¯æ ¼å¼åŒ–

ä¸åŒæµè§ˆå™¨é”™è¯¯ä¿¡æ¯æ ¼å¼å¯èƒ½ä¸åŒã€‚å¯ä»¥ä½¿ç”¨`tracekitåº“` [å‚è€ƒæ–‡æ¡£](https://github.com/csnoverTraceKit) å¯¹é”™è¯¯ä¿¡æ¯æ ¼å¼åŒ–ã€‚
### é”™è¯¯çš„ä¸ŠæŠ¥

1. ajaxä¸ŠæŠ¥é”™è¯¯
2. ä½¿ç”¨gifå›¾ä¸ŠæŠ¥é”™è¯¯ï¼Œå¦‚ï¼šhttps://www.xxxx.com/r.gif?a=1&b=2&c=3

#### åŸ‹ç‚¹ä¸ºä»€ä¹ˆä½¿ç”¨gif

1. èƒ½å¤Ÿå®Œæˆæ•´ä¸ªHTTPï¼Œè¯·æ±‚+å“åº”
2. è·¨åŸŸå‹å¥½ï¼ˆimg å¤©ç„¶æ”¯æŒè·¨åŸŸï¼‰
3. ç›¸æ¯” XMLHttpRequest å¯¹è±¡å‘é€ GET è¯·æ±‚ï¼Œæ€§èƒ½ä¸Šæ›´å¥½
4. GIF çš„æœ€ä½åˆæ³•ä½“ç§¯æœ€å°ï¼ˆæœ€å°çš„ BMP æ–‡ä»¶éœ€è¦ 74 ä¸ªå­—èŠ‚ï¼ŒPNG éœ€è¦ 67 ä¸ªå­—èŠ‚ï¼Œè€Œåˆæ³•çš„ GIFï¼Œåªéœ€è¦ 43 ä¸ªå­—èŠ‚ï¼‰
5. ä¸ä¼šé˜»å¡é¡µé¢åŠ è½½ï¼Œå½±å“ç”¨æˆ·çš„ä½“éªŒï¼Œåªè¦ new Image å¯¹è±¡å°±å¥½äº†ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¹Ÿä¸éœ€è¦ append åˆ° DOM ä¸­ï¼Œé€šè¿‡å®ƒçš„ onerror å’Œ onload äº‹ä»¶æ¥æ£€æµ‹å‘é€çŠ¶æ€ã€‚
### å®šä½å¤–ç½‘é”™è¯¯ä½ç½®

çº¿ä¸Šçš„ä»£ç éƒ½æ˜¯æ··æ·†å‹ç¼©çš„ï¼Œæ— æ³•ç›´æ¥å®šä½æºç ä¸­çš„é”™è¯¯ã€‚å¯ä»¥ä½¿ç”¨SourceMapä¸­çš„mappingså±æ€§è¿˜åŸæºç ã€‚åœ¨å‘å¸ƒæ—¶ï¼Œå¯ä»¥åœ¨å†…ç½‘ä¿å­˜SourceMapæ–‡ä»¶ï¼Œä½¿ç”¨`https://github.com/mozilla/source-map`è¿™ä¸ªåº“å®šä½é”™è¯¯ã€‚

> https://github.com/BengBu-YueZhang/trashcan-broomï¼Œæ¥é”™è¯¯ä¿¡æ¯ç»“åˆSourceMapæ–‡ä»¶å®šä½é”™è¯¯çš„ä»£ç ã€‚

> ä¹‹å‰å…¬å¸æ˜¯é€šè¿‡ä¸Šä¼ source-mapæ–‡ä»¶ï¼Œæ ¹æ®çº¿ä¸Šé”™è¯¯çš„ä¿¡æ¯è¿˜åŸå…·ä½“çš„é”™è¯¯

## ğŸ˜Š è¯´ä¸€è¯´å‰ç«¯çš„æ€§èƒ½æŒ‡æ ‡ï¼Œä»¥åŠæ€§èƒ½ç›‘æ§
### å‰ç«¯æ€§èƒ½æŒ‡æ ‡

> Long Tasks, é•¿ä»»åŠ¡ï¼ŒæŒ‡çš„æ‰€æœ‰æ‰§è¡Œæ—¶é—´è¶…è¿‡50msçš„ä»»åŠ¡

> SSRæŠ€æœ¯è¦é¿å…TTIæ—¶é—´è¿‡é•¿ï¼Œé¿å…ç”¨æˆ·è®¤ä¸ºé¡µé¢æ— å“åº”

- FCPï¼Œä»é¡µé¢å¼€å§‹åŠ è½½åˆ°å±å¹•ä¸Šå‘ˆç°é¡µé¢å†…å®¹ï¼ˆä»»æ„éƒ¨åˆ†ï¼‰çš„æ—¶é—´ã€‚ä»»æ„éƒ¨åˆ†æŒ‡ï¼šæ–‡æœ¬ï¼Œå›¾åƒï¼ŒèƒŒæ™¯å›¾ç‰‡ï¼Œsvgå’Œéç©ºç™½çš„canvaså…ƒç´ ã€‚
- TTIï¼Œä»é¡µé¢å¼€å§‹åŠ è½½å¼€å§‹åˆ°å…¶ä¸»è¦çš„å­èµ„æºåŠ è½½å®Œæ¯•ä¹‹é—´çš„æ—¶é—´ã€‚TTIèƒ½åˆ¤æ–­é¡µé¢æ˜¯å¦å¯ä»¥å¿«é€Ÿçš„å“åº”ç”¨æˆ·çš„è¾“å…¥ã€‚TTIçš„è®¡ç®—è¿‡ç¨‹:
  1. ä»FCPå¼€å§‹ã€‚
  2. ä»FCPå‘åæŸ¥æ‰¾æ˜¯å¦æœ‰5sçš„é™é»˜çª—å£ï¼Œé™é»˜çª—å£çš„å®šä¹‰æ˜¯: æ²¡æœ‰é•¿ä»»åŠ¡ï¼Œå¤„äºpendingä¸­çš„GETè¯·æ±‚ä¸è¶…è¿‡2ä¸ªã€‚
  3. ä»é™é»˜çª—å£å¼€å§‹å‘å‰æŸ¥æ‰¾æŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªé•¿ä»»åŠ¡çš„ã€‚å¦‚æœæ‰¾ä¸åˆ°é•¿ä»»åŠ¡ï¼Œåˆ™åˆ°FCPä¸ºæ­¢ã€‚
  4. TTIçš„æ—¶é—´ï¼Œæ˜¯é™é»˜çª—å£å‘å‰æŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªé•¿ä»»åŠ¡çš„ç»“æŸçš„æ—¶é—´ã€‚å¦‚æœæ²¡æœ‰é•¿ä»»åŠ¡ï¼Œåˆ™æ˜¯FCPçš„æ—¶é—´ã€‚
- LCPï¼Œä»é¡µé¢é¦–æ¬¡åŠ è½½ï¼Œåˆ°çª—å£ä¸­å¯è§æœ€å¤§å›¾åƒå’Œæ–‡æœ¬å—çš„æ—¶é—´ã€‚
  - æœ€å¤§å†…å®¹åŒ…å«äº†imgå…ƒç´ ï¼Œvideoå…ƒç´ ï¼ŒåŒ…å«èƒŒæ™¯å›¾ç‰‡çš„å…ƒç´ ï¼Œæˆ–è€…åŒ…å«æ–‡æœ¬çš„å—çº§å…ƒç´ 
- FIDï¼Œç”¨æˆ·ç¬¬ä¸€æ¬¡ä¸é¡µé¢è¿›è¡Œäº¤äº’ï¼ˆç‚¹å‡»æŒ‰é’®ï¼‰åˆ°æµè§ˆå™¨å“åº”äº¤äº’çš„æ—¶é—´ã€‚
- TBTï¼Œæµ‹é‡äº†ä»FCPåˆ°TTIä¹‹é—´çš„æ‰€æœ‰é•¿ä»»åŠ¡ï¼ˆLong Tasksï¼‰æ—¶é•¿çš„æ€»å’Œã€‚
- CLSï¼Œé¡µé¢æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­å‘ç”Ÿçš„æ¯ä¸ªæ„å¤–çš„ç‰ˆå¼ç§»ä½åˆ†æ•°çš„æ€»å’Œã€‚

ä¸‹é¢æŒ‡æ ‡ä¸æ¨èä½¿ç”¨ï¼š

- FMP, é¦–æ¬¡æœ‰æ•ˆç»˜åˆ¶æ—¶é—´ï¼ŒFMPè¡¡é‡ç”¨æˆ·ä½•æ—¶å¯ä»¥çœ‹åˆ°é¡µé¢çš„ä¸»è¦å†…å®¹ã€‚è¯¥æŒ‡æ ‡çš„å®šä¹‰ä¾èµ–äºç‰¹å®šäºæµè§ˆå™¨çš„å®ç°ç»†èŠ‚ï¼Œè¿™æ„å‘³ç€å®ƒä¸èƒ½åœ¨æ‰€æœ‰Webæµè§ˆå™¨ä¸­æ ‡å‡†åŒ–æˆ–å®ç°ã€‚ç›®å‰ä½¿ç”¨LCPä»£æ›¿ã€‚

### å¦‚ä½•ç›‘æ§è¿™äº›æŒ‡æ ‡?

> è¿™ä¸ªæ€»ç»“ä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œå…·ä½“æ²¡æœ‰å®è·µè¿‡

> è¿™ä¸ªéœ€è¦çœ‹ä¸‹ä¹‹å‰å…¬å¸çš„é¡¹ç›®ï¼Œåœ¨é¡¹ç›®.mdæ–‡ä»¶é‡Œ

å¯ä»¥ä½¿ç”¨[web-vitals](https://github.com/GoogleChrome/web-vitals#send-the-results-to-an-analytics-endpoint)ç›‘æ§æŒ‡æ ‡ï¼Œä½¿ç”¨ajaxæˆ–è€…gifçš„å½¢å¼ä¸ŠæŠ¥æ€§èƒ½æ•°æ®ã€‚
## ğŸ˜Š è¯´ä¸€è¯´å‰ç«¯é¡µé¢ç§’å¼€ä¼˜åŒ–

- å‡å°‘èµ„æºè¯·æ±‚æ•°é‡
  - é›ªç¢§å›¾ï¼Œå°†å¤šå¼ å›¾ç‰‡åˆæˆä¸ºåŒä¸€å¼ å›¾ç‰‡ï¼›å°†å°å›¾ç‰‡è½¬ä¸ºbase64ã€‚
  - å›¾ç‰‡æ‡’åŠ è½½ï¼Œè™šæ‹Ÿåˆ—è¡¨ã€‚å‡å°‘é¦–å±çš„å›¾ç‰‡è¯·æ±‚æ•°é‡ã€‚
  - nodeä¸­é—´å±‚ï¼Œæˆ–è€…ä½¿ç”¨GraphQLã€‚åˆå¹¶httpè¯·æ±‚æ¥å£
- å‡å°‘èµ„æºè¯·æ±‚å¤§å°
  - å›¾ç‰‡ä½¿ç”¨webpæ ¼å¼ï¼Œå‡å°‘å›¾ç‰‡å¤§å°ï¼ˆsafariä½ç‰ˆæœ¬ä¸æ”¯æŒï¼‰
  - jsï¼Œcssèµ„æºè¿›è¡Œå‹ç¼©
  - ä½¿ç”¨æ ‘æ‘‡ï¼ŒæŒ‰éœ€åŠ è½½ï¼Œé¿å…æ‰“åŒ…ä¸ä½¿ç”¨çš„ä»£ç 
  - nginxå¼€å¯gzipå‹ç¼©
- é¿å…é¡µé¢é˜»å¡
  - jsæ”¾åˆ°é¡µé¢åº•éƒ¨ï¼Œæˆ–è€…æ·»åŠ deferå’Œasyncå±æ€§ï¼Œ`jsçš„é˜»å¡æ—¶é—´ = jsä¸‹è½½æ—¶é—´ + jsæ‰§è¡Œæ—¶é—´`ã€‚
  - é¿å…jså‡ºç°é•¿ä»»åŠ¡ï¼ˆæ‰§è¡Œæ—¶é—´è¶…è¿‡50msçš„ä»»åŠ¡ï¼‰é˜»å¡é¡µé¢çš„æ¸²æŸ“
  - cssä¹Ÿæ˜¯é˜»å¡èµ„æºï¼Œä¹Ÿä¼šé˜»å¡é¡µé¢çš„æ¸²æŸ“ã€‚ä½†æ˜¯ä¸ä¼šé˜»å¡htmlçš„è§£æã€‚
- é¢„è¯»å–ï¼Œé¢„é“¾æ¥
  - xhré¢„è¯»å–ï¼Œ`<link rel=prefetch>`ä¸èƒ½ä¿è¯æµè§ˆå™¨ä¼šé¢„å–ï¼ˆ30%ï½90%çš„æ¦‚ç‡ï¼‰ï¼Œå¹¶ä¸”æœ‰çš„æµè§ˆå™¨ä¸å…¼å®¹ã€‚xhré¢„è¯»å–æœ‰95%çš„æ¦‚ç‡ã€‚
  - dnsé¢„è¯»å–ï¼Œ`<link rel="dns-prefetch" href="//hm.baidu.com" />`, å¯¹ç½‘é¡µä¸­åŸŸåè¿›è¡Œdnsçš„é¢„å…ˆè§£æã€‚
  - é¢„è¿æ¥ï¼Œ`<link rel="preconnect" href="//p3.music.126.net" crossorigin="use-credentials"/>`, å»ºç«‹æ—©æœŸçš„è¿æ¥ï¼ŒDNSæŸ¥æ‰¾ï¼ŒTCPæ¡æ‰‹å’ŒTLSåå•†
- cssä¼˜åŒ–
  - cssæ ·å¼ï¼Œcontent-visibilityè·³è¿‡å±å¹•å¤–çš„æ¸²æŸ“
  - ä½¿ç”¨cssè§¦å‘gpuåŠ é€Ÿ
- ç¼“å­˜
  - å¼ºç¼“å­˜ï¼ˆğŸ¥¤æ›´è¯¦ç»†çš„å†…å®¹ï¼Œå‚è€ƒhttpç« èŠ‚ï¼‰
    1. cache-control
    2. expires
  - åå•†ç¼“å­˜ï¼ˆğŸ¥¤æ›´è¯¦ç»†çš„å†…å®¹ï¼Œå‚è€ƒhttpç« èŠ‚ï¼‰
    1. Etag/If-None-Match
    2. Last-Modified/If-Modified-Since
  - ServiceWorkå®ç°ç¦»çº¿ç¼“å­˜ï¼Œæ¥å£çš„ç¦»çº¿ç¼“å­˜ã€‚
- å…¶ä»–
  - é™æ€èµ„æºéƒ¨ç½²åˆ°cdnä¸Šï¼ˆğŸ¥¤æ›´è¯¦ç»†çš„å†…å®¹ï¼Œå‚è€ƒhttpç« èŠ‚ï¼‰ã€‚æé«˜ç”¨æˆ·è®¿é—®ç½‘ç«™çš„å“åº”é€Ÿåº¦ã€‚
  - å¯¹äºcpuå¯†é›†å‹çš„ä»»åŠ¡å¯ä»¥å¼€å¯WebWorkerè¿ç®—ï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹è¿›è¡Œè¿ç®—ã€‚

### preload å’Œ prefetch çš„åŒºåˆ«

- preload ä¼˜å…ˆçº§é«˜ã€‚å‘Šè¯‰æµè§ˆå™¨å®ƒå¿…é¡»å°½å¿«ä¸‹è½½ç»™å®šçš„èµ„æºã€‚ç”¨äºå½“å‰é¡µçš„èµ„æºã€‚
- prefetch ä¼˜å…ˆçº§ä½ã€‚å‘æµè§ˆå™¨è¡¨æ˜å®ƒå¯ä»¥ä¸‹è½½ç»™å®šçš„èµ„æºï¼Œå³ä½¿å®ƒæ²¡æœ‰åœ¨é¡µé¢ä¸­æ£€æµ‹åˆ°ã€‚å¸¸ç”¨äºé¢„å…ˆåŠ è½½ä¸‹ä¸€é¡µçš„èµ„æºã€‚

## ğŸ˜Š è¯´ä¸€è¯´ç»„ä»¶åº“
### ç»„ä»¶åº“æ˜¯å¦‚ä½•æ‰“åŒ…çš„ï¼Ÿ

å‚è€ƒäº†vueï¼Œreactç­‰å¤šä¸ªç»„ä»¶åº“çš„æ‰“åŒ…æ–¹å¼å¦‚ä¸‹

å¯¹äºjsæ–‡ä»¶ï¼š
  - ç”±äºwebpackä¸æ”¯æŒæ‰“åŒ…ä¸ºesæ¨¡å—ï¼Œä¸€èˆ¬ä½¿ç”¨webpackå°†jsæ–‡ä»¶æ‰“åŒ…æˆcjsçš„æ¨¡å—
  - å¦‚æœéœ€è¦æ‰“åŒ…æˆesæ¨¡å—ï¼Œä½¿ç”¨gulpæ‰“åŒ…ï¼Œå¹¶æŒ‡å®šæ‰“åŒ…ä¸ºesæ¨¡å—
  - ç”¨äºæŒ‰éœ€å¼•å…¥çš„ç»„ä»¶åº“æ–‡ä»¶ä¹Ÿä½¿ç”¨gulpå•ç‹¬æ‰“åŒ…
  - ä½¿ç”¨externalsæ’é™¤vueï¼Œreactåº“ä»£ç 
å¯¹äºcssæ–‡ä»¶
  - ç»„ä»¶åº“ä¸€èˆ¬å°†cssæ–‡ä»¶å’Œjsæ–‡ä»¶åˆ†å¼€æ‰“åŒ…ï¼Œcssæ–‡ä»¶ä¹Ÿæ˜¯é€šè¿‡gulpè¿›è¡Œæ‰“åŒ…ï¼Œæœ€åæ‰“åŒ…æˆä¸€ä¸ªcssæ–‡ä»¶ã€‚csså‘½åéœ€è¦ä¸¥æ ¼æŒ‰ç…§è§„èŒƒé¿å…classå‘½åå†²çªã€‚
å¯¹äºtsæ–‡ä»¶
  - ä½¿ç”¨babelå°†å…¶æ‰“åŒ…ä¸ºjsæ–‡ä»¶
  - tsçš„æè¿°æ–‡ä»¶ä½¿ç”¨tscå‘½ä»¤è‡ªåŠ¨ç”Ÿæˆ

### ç»„ä»¶åº“æŒ‰éœ€å¼•å…¥çš„åŸç†ï¼Ÿ

å¯¹äºjsæŒ‰éœ€å¼•å…¥
  - æ‰‹åŠ¨æŒ‰éœ€å¼•å…¥ã€‚ä¸€èˆ¬åœ¨æ‰“åŒ…ç»„ä»¶åº“çš„æ—¶å€™ï¼Œä¼šæ‰“åŒ…ä¸€ä¸ªä¸“é—¨ç”¨äºæŒ‰éœ€å¼•å…¥çš„ç»„ä»¶çš„ç›®å½•ï¼Œæ‰‹åŠ¨æŒ‰éœ€å¼•å…¥æ—¶ï¼Œç›´æ¥å¼•å…¥è¯¥ç›®å½•ä¸‹çš„ç‰¹å®šç»„ä»¶
  - è‡ªåŠ¨æŒ‰éœ€å¼•å…¥ã€‚ä½¿ç”¨`babel-plugin-import`æ’ä»¶ï¼Œåœ¨æ‰“åŒ…é¡¹ç›®ä»£ç æ—¶ï¼Œä¼šè‡ªåŠ¨æ›´æ”¹å¼•å…¥çš„ç›®å½•ä¸ºæŒ‰éœ€å¼•å…¥çš„ç›®å½•ã€‚
å¯¹äºcssæŒ‰éœ€å¼•å…¥
  - æ‰‹åŠ¨æŒ‰éœ€å¼•å…¥ã€‚å’ŒjsåŒç†ï¼Œåªå¼•å…¥ç»„ä»¶å•ç‹¬çš„cssæ–‡ä»¶ã€‚
  - è‡ªåŠ¨æŒ‰éœ€å¼•å…¥ã€‚ä¹Ÿæ˜¯ä½¿ç”¨`babel-plugin-import`æ’ä»¶ï¼Œæ›´æ”¹é¡¹ç›®ä»£ç çš„å¼•å…¥ç›®å½•ã€‚

### babel-plugin-importçš„åŸç†

## ğŸ˜Š è¯´ä¸€è¯´CommonJS, AMD, UMD, ES6æ¨¡å—çš„å·®å¼‚

1. CommonJSï¼ˆNodejsçš„æ¨¡å—è§„èŒƒå’ŒCommonJSä¸å®Œå…¨ä¸€æ ·ï¼ŒCommonJSä¸æ”¯æŒmodule.exportså¯¼å‡ºå¯¹è±¡ï¼‰ã€‚CommonJSæ¨¡å—åœ¨æœªç»ç¼–è¯‘å‰æ— æ³•ä½¿ç”¨
  - ä½¿ç”¨requireï¼Œexportså…³é”®å­—å¯¼å‡ºï¼Œå¯¼å…¥ã€‚
  - ä¸æ”¯æŒå¼‚æ­¥åŠ è½½
  - ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—
  - CommonJS æ¨¡å—è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå€¼çš„æ‹·è´, å³ï¼šæ¨¡å—å¯ä»¥å¤šæ¬¡åŠ è½½ï¼Œä½†æ˜¯åªä¼šåœ¨ç¬¬ä¸€æ¬¡åŠ è½½æ—¶è¿è¡Œä¸€æ¬¡ï¼Œç„¶åè¿è¡Œç»“æœå°±è¢«ç¼“å­˜äº†ï¼Œä»¥åå†åŠ è½½ï¼Œå°±ç›´æ¥è¯»å–ç¼“å­˜ç»“æœã€‚è¦æƒ³è®©æ¨¡å—å†æ¬¡è¿è¡Œï¼Œå¿…é¡»æ¸…é™¤ç¼“å­˜ã€‚
  - CommonJS æ¨¡å—æ˜¯è¿è¡Œæ—¶åŠ è½½ï¼Œæ¨¡å—åªæœ‰åœ¨è„šæœ¬è¿è¡Œå®Œæ‰ä¼šç”Ÿæˆ
2. AMD
  - æ”¯æŒå¼‚æ­¥åŠ è½½
  - éœ€è¦æ‰‹åŠ¨å¼•å…¥`require.js`æ–‡ä»¶ï¼Œä»¥è®©æµè§ˆå™¨æ”¯æŒamd
  - defineå…³é”®å­—å®šä¹‰æ¨¡å—
  - requireå¼•å…¥æ¨¡å—
3. UMD
  - UMDæ˜¯é€šç”¨çš„æ¨¡å—ï¼Œå…¼å®¹AMDå’ŒCommonJSçš„è§„èŒƒ
  - UMDæ¨¡å—çš„é¡¶ç«¯é€šå¸¸ä¼šæœ‰åˆ¤æ–­æ¨¡å—åŠ è½½å™¨ç¯å¢ƒçš„ä»£ç 
4. ES6
  - ESæ˜¯é™æ€æ¨¡å—ï¼Œç¼–è¯‘æ—¶è¾“å‡ºæ¥å£ï¼Œåªèƒ½åœ¨æ–‡ä»¶é¡¶éƒ¨ä½¿ç”¨
  - ES6æ¨¡å—æ²¡æ³•åœ¨æµè§ˆå™¨ä¸­å®Œå…¨å®ç°ï¼Œéœ€è¦ä½¿ç”¨babelï¼Œwebpackæ‰èƒ½å¤Ÿä½¿ç”¨
  - ES6 JS å¼•æ“å¯¹è„šæœ¬é™æ€åˆ†æçš„æ—¶å€™ï¼Œé‡åˆ°æ¨¡å—è®°è½½å‘½ä»¤ importï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªåªè¯»å¼•ç”¨ï¼Œç­‰åˆ°è„šæœ¬çœŸæ­£æ‰§è¡Œæ—¶ï¼Œå†æ ¹æ®è¿™ä¸ªåªè¯»å¼•ç”¨ï¼Œåˆ°è¢«åŠ è½½çš„é‚£ä¸ªæ¨¡å—é‡Œé¢å»å–å€¼ã€‚ES6æ¨¡å—æ˜¯åŠ¨æ€å¼•ç”¨ï¼Œå¹¶ä¸”ä¸ä¼šç¼“å­˜å€¼ã€‚

### ES6 æ¨¡å—ä¸ CommonJS æ¨¡å—çš„å·®å¼‚

- CommonJS æ¨¡å—è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå€¼çš„æ‹·è´ï¼ˆcloneï¼‰ï¼ŒES6 æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ã€‚
- CommonJS æ¨¡å—æ˜¯è¿è¡Œæ—¶åŠ è½½ï¼ŒES6 æ¨¡å—æ˜¯ç¼–è¯‘æ—¶è¾“å‡ºæ¥å£

## ğŸ˜Š ç™½å±é—®é¢˜å¦‚ä½•ä¼˜åŒ–?

> ä¹Ÿæœ‰å¯èƒ½æ˜¯é¡µé¢å´©æºƒå¯¼è‡´çš„ï¼Œè¯·çœ‹â€œå¦‚ä½•æ£€æµ‹é¡µé¢çš„å´©æºƒï¼Ÿâ€

ç™½å±æ—¶é—´ï¼šå³ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªé“¾æ¥æˆ–æ‰“å¼€æµè§ˆå™¨è¾“å…¥URLåœ°å€åï¼Œä»å±å¹•ç©ºç™½åˆ°æ˜¾ç¤ºç¬¬ä¸€ä¸ªç”»é¢çš„æ—¶é—´ã€‚ï¼ˆFCPæ—¶é—´ï¼‰

æ‰“å¼€çš„ä¸€ä¸ªé¡µé¢åˆ°æ˜¾ç¤ºé¡µé¢ï¼Œç»å†çš„è¿‡ç¨‹ï¼Œç®€å•è¿‡ç¨‹å¦‚ä¸‹ï¼š

1. DNS Lookupï¼ˆDNSæŸ¥è¯¢ï¼‰
2. TCPè¿æ¥
3. æœåŠ¡ç«¯è¯·æ±‚å¤„ç†å“åº”
4. å®¢æˆ·ç«¯ä¸‹è½½ã€è§£æã€æ¸²æŸ“æ˜¾ç¤ºé¡µé¢

### ç™½å±å¦‚ä½•ä¼˜åŒ–ï¼Ÿ

1. DNSè§£æä¼˜åŒ–
 - DNSç¼“å­˜ä¼˜åŒ–
 - DNSé¢„åŠ è½½ç­–ç•¥
 - ç¨³å®šå¯é çš„DNSæœåŠ¡å™¨
2. æœåŠ¡ç«¯å¤„ç†ä¼˜åŒ–
 - å¤„ç†å¥½ç¼“å­˜
3. æµè§ˆå™¨ä¸‹è½½ã€è§£æã€æ¸²æŸ“é¡µé¢ä¼˜åŒ–
  - é¿å…jså’Œcssçš„é˜»å¡

## ğŸ˜Š å¦‚ä½•å®šä½å†…å­˜æ³„éœ²?

ChromedevToolsæŸ¥çœ‹ï¼ˆè¿™ä¸ªç¡®å®æ²¡æ€ä¹ˆç”¨è¿‡ï¼Œç›®å‰çŸ¥é“æœ‰è¿™ä¸ªç©æ„ï¼‰

![å†…å­˜.png](https://i.loli.net/2021/07/28/nwEmDPGMskSQ1xU.png)

é¡µé¢ä»é›¶åˆ°åŠ è½½å®Œæˆè¿™ä¸ªè¿‡ç¨‹ä¸­JS Heapï¼ˆjså †å†…å­˜ï¼‰ã€documentsï¼ˆæ–‡æ¡£ï¼‰ã€Nodesï¼ˆDOMèŠ‚ç‚¹ï¼‰ã€Listenersï¼ˆç›‘å¬å™¨ï¼‰ã€GPU memoryï¼ˆGPUå†…å­˜ï¼‰çš„æœ€ä½å€¼ã€æœ€é«˜å€¼ä»¥åŠéšæ—¶é—´çš„èµ°åŠ¿æ›²çº¿ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸»è¦å…³æ³¨çš„ç‚¹

`Memory` ä¸€æ ï¼Œå…¶ä¸»è¦æ˜¯ç”¨äºè®°å½•é¡µé¢å †å†…å­˜çš„å…·ä½“æƒ…å†µä»¥åŠjså †å†…å­˜éšåŠ è½½æ—¶é—´çº¿åŠ¨æ€çš„åˆ†é…æƒ…å†µã€‚å †å¿«ç…§å°±åƒç…§ç›¸æœºä¸€æ ·ï¼Œèƒ½è®°å½•ä½ å½“å‰é¡µé¢çš„å †å†…å­˜æƒ…å†µï¼Œæ¯å¿«ç…§ä¸€æ¬¡å°±ä¼šäº§ç”Ÿä¸€æ¡å¿«ç…§è®°å½•ã€‚

![Memory.png](https://i.loli.net/2021/07/28/6nDq9IzlpUkXb4r.png)

### é‚£äº›å¯èƒ½å¼•èµ·å†…å­˜æ³„æ¼çš„åŸå› 

1. é—­åŒ…ä½¿ç”¨ä¸å½“
2. å…¨å±€å˜é‡
3. æ§åˆ¶å°çš„æ‰“å°
4. é—å¿˜çš„å®šæ—¶å™¨ï¼ˆå®šæ—¶å™¨æ²¡æœ‰æ¸…ç†ï¼‰
5. DOMå¼•ç”¨ï¼Œä»¥åŠäº‹ä»¶æœªæ¸…é™¤ï¼Œå¦‚ 'rezie'

## ğŸ˜Š å‘å¸ƒ/è®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

![è®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼.png](https://i.loli.net/2021/07/28/TEVFKojLevaQ6gC.png)

è§‚å¯Ÿè€…æ¨¡å¼å’Œå‘å¸ƒè®¢é˜…æ¨¡å¼æœ€å¤§çš„åŒºåˆ«å°±æ˜¯å‘å¸ƒè®¢é˜…æ¨¡å¼æœ‰ä¸ªäº‹ä»¶è°ƒåº¦ä¸­å¿ƒã€‚è§‚å¯Ÿè€…æ¨¡å¼ä¸­è§‚å¯Ÿè€…å’Œç›®æ ‡ç›´æ¥è¿›è¡Œäº¤äº’ï¼Œè€Œå‘å¸ƒè®¢é˜…æ¨¡å¼ä¸­ç»Ÿä¸€ç”±è°ƒåº¦ä¸­å¿ƒè¿›è¡Œå¤„ç†ï¼Œè®¢é˜…è€…å’Œå‘å¸ƒè€…äº’ä¸å¹²æ‰°ã€‚

`EventEmitter`æ˜¯å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œè€Œä¸æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ã€‚è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè§‚å¯Ÿè€…å’Œç›®æ ‡ç›´æ¥è¿›è¡Œäº¤äº’ã€‚

```js
// è§‚å¯Ÿè€…æ¨¡å¼çš„å®ç°

// è§‚å¯Ÿè€…
class Observer {
    constructor(cb){
        if (typeof cb === 'function') {
            this.cb = cb
        } else {
            throw new Error('Observeræ„é€ å™¨å¿…é¡»ä¼ å…¥å‡½æ•°ç±»å‹ï¼')
        }
    }

    update() {
        this.cb()
    }
}

// ç›®æ ‡å¯¹è±¡
class Subject {
    constructor() {
        this.observerList = []
    }
    addObserver(observer) {
        this.observerList.push(observer)
    }
    notify() {
        this.observerList.forEach(observer => {
            observer.update()
        })
    }
}

const observerCallback = function() {
    console.log('æˆ‘è¢«é€šçŸ¥äº†')
}
const observer = new Observer(observerCallback)

const subject = new Subject();
subject.addObserver(observer);
subject.notify();
```
## ğŸ˜Š åˆ—ä¸¾ä½ æ‰€äº†è§£çš„ç¼–ç¨‹èŒƒå¼ï¼Ÿ

1. å‘½ä»¤å¼ç¼–ç¨‹
2. å‡½æ•°å¼ç¼–ç¨‹(FP)ï¼Œå‡½æ•°è¦æ±‚æ˜¯çº¯å‡½æ•°ã€‚
3. é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰

## ğŸ˜Š [js-bridgeé€šä¿¡åŸç†ï¼Ÿ](https://zhuanlan.zhihu.com/p/438763800)

js-bridgeå°±æ˜¯åŸç”Ÿç«¯å’Œwebç«¯ä¹‹é—´çš„æ¡¥æ¢

### Native -> Web (åŸç”Ÿè°ƒç”¨JS)

Nativeç«¯ç›´æ¥æ‹¼æ¥JSä»£ç ï¼Œæ³¨å…¥Webviewæ‰§è¡Œ

```js
// å®‰å“
String jsCode = String.format("window.showWebDialog('%s')", text);
webView.loadUrl("javascript: " + jsCode);
// ios
NSString *jsStr = "æ‰§è¡Œçš„JSä»£ç ";
[webView stringByEvaluatingJavaScriptFromString:jsStr];
```

### Web -> Native ï¼ˆJSè°ƒç”¨åŸç”Ÿï¼‰
### ç¬¬ä¸€ç§ (ä»“åº“ï¼š[JsBridge](https://github.com/pengwei1024/JsBridge))

æ‹¦æˆªWebviewè¯·æ±‚çš„URL Schemaï¼ˆURL Schemaæ˜¯ä¸€ç§ç‰¹æ®Šçš„URL, ç±»ä¼¼:`<protocol>://<host>/<path>?<qeury>#fragment`ï¼‰ï¼Œä¹Ÿå¯ä»¥ç”¨ä½œwebç«¯å”¤é†’APPä½¿ç”¨

Webå‘é€çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šç»è¿‡WebViewç»„ä»¶ï¼Œæ‰€ä»¥Nativeå¯ä»¥é‡å†™WebViewé‡Œçš„æ–¹æ³•ï¼Œä»æ¥æ‹¦æˆªWebå‘èµ·çš„è¯·æ±‚

### ç¬¬äºŒç§ (ä»“åº“ï¼š[DsBridge](https://github.com/wendux))

Appå°†Nativeçš„ç›¸å…³æ¥å£æ³¨å…¥åˆ°JSçš„Contextï¼ˆwindowï¼‰çš„å¯¹è±¡ä¸­ï¼Œä¸€èˆ¬æ¥è¯´è¿™ä¸ªå¯¹è±¡å†…çš„æ–¹æ³•åä¸Nativeç›¸å…³æ–¹æ³•åæ˜¯ç›¸åŒçš„ï¼ŒWebç«¯å°±å¯ä»¥ç›´æ¥åœ¨å…¨å±€windowä¸‹ä½¿ç”¨è¿™ä¸ªæš´éœ²çš„å…¨å±€JSå¯¹è±¡ï¼Œè¿›è€Œè°ƒç”¨åŸç”Ÿç«¯çš„æ–¹æ³•ã€‚

### ç¬¬ä¸‰ç§ ï¼ˆäº‹ä»¶æ‹¦æˆªï¼ŒpostMessageï¼‰
```
// IOS
window.webkit.messageHandlers.`çº¦å®šäº‹ä»¶å`.postMessage(data)  // ä¸å¯ä¸ºç©ºï¼Œé»˜è®¤ ''

// Android 
window.`çº¦å®šä»£ç†å¯¹è±¡`.`çº¦å®šäº‹ä»¶å`(data)

```

## DS

## ğŸ˜Š è¯´è¯´ MVCï¼ŒMVVM

![mvc.png](https://i.loli.net/2021/07/28/bvXiUL7Ftl6T1Mn.png)

- Model: æ•°æ®æ¨¡å‹ (ç”¨äºå¤„ç†åº”ç”¨ç¨‹åºæ•°æ®é€»è¾‘çš„éƒ¨åˆ†ï¼Œå¦‚æ•°æ®åº“)
- View: è§†å›¾ (ç”¨äºæ¸²æŸ“é¡µé¢, é€šå¸¸è§†å›¾æ˜¯ä¾æ®æ¨¡å‹æ•°æ®åˆ›å»ºçš„)
- Controller: æ§åˆ¶å™¨ (ä¸šåŠ¡é€»è¾‘, é€šå¸¸æ§åˆ¶å™¨è´Ÿè´£ä»è§†å›¾è¯»å–æ•°æ®ï¼Œæ§åˆ¶ç”¨æˆ·è¾“å…¥ï¼Œå¹¶å‘æ¨¡å‹å‘é€æ•°æ®ã€‚)

Koa, Expressä½¿ç”¨çš„å°±æ˜¯MVCæ¨¡å¼

![mvvm.png](https://i.loli.net/2021/07/28/8R14NdLrgltIKVG.png)

- Model: æ•°æ®æ¨¡å‹ ä»£è¡¨æ•°æ®æ¨¡å‹ï¼Œæ•°æ®å’Œä¸šåŠ¡é€»è¾‘éƒ½åœ¨ Model å±‚ä¸­å®šä¹‰
- ViewModel è´Ÿè´£ç›‘å¬ Model ä¸­æ•°æ®çš„æ”¹å˜å¹¶ä¸”æ§åˆ¶è§†å›¾çš„æ›´æ–°ã€‚
- View: è§†å›¾ ä»£è¡¨ UI è§†å›¾ï¼Œè´Ÿè´£æ•°æ®çš„å±•ç¤º

Vueï¼ŒReactä½¿ç”¨çš„MVVMæ¨¡å¼

## ğŸ˜Š å‰ç«¯å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼

- å•ä¾‹æ¨¡å¼ï¼ˆreduxåº”è¯¥åº”ç”¨äº†å•ä¾‹æ¨¡å¼ï¼‰
- å·¥å‚æ¨¡å¼
- ç­–ç•¥æ¨¡å¼ï¼ˆæ•°æ®æ ¡éªŒçš„åœºæ™¯ç”¨çš„æ¯”è¾ƒå¤šï¼‰
- ä»£ç†æ¨¡å¼ï¼ˆèŠ‚æµï¼Œé˜²æŠ–åº”è¯¥ä¹Ÿç®—ä»£ç†æ¨¡å¼çš„ä¸€ç§ï¼‰
- è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆEventEmitterä¸å¤šè¯´äº†ï¼‰
- æ¨¡å—æ¨¡å¼
- æ„é€ å‡½æ•°æ¨¡å¼
- æ··åˆæ¨¡å¼

æˆ‘æ¯”è¾ƒç”¨çš„å¤šçš„æ˜¯ç­–ç•¥æ¨¡å¼ï¼ŒæŠŠæ¯ä¸€ç§æ•°æ®æ ¡éªŒçš„è§„åˆ™è¿›è¡ŒæŠ½è±¡ï¼Œå½“é‡åˆ°æœ‰æ•°æ®æ ¡éªŒçš„éœ€æ±‚çš„æ—¶å€™ï¼Œåªéœ€è¦åƒæ­ç§¯æœ¨ä¼¼çš„ï¼ŒæŠŠå„ç§ç­–ç•¥ç»„åˆä¸€ä¸‹å³å¯ã€‚
## ğŸ˜Š äº†è§£è¿‡lerna(å‹’çº³)å—ï¼Ÿ

ç›®å‰å…·ä½“æ²¡æœ‰ä½¿ç”¨lernaã€‚lernaæ˜¯ç”¨æ¥ç®¡ç†ï¼Œä¸€ä¸ªé¡¹ç›®é‡Œå…·æœ‰å¤šä¸ªåŒ…çš„å·¥å…·ã€‚babelä½¿ç”¨å°±æ˜¯lernaã€‚

## å•ç‚¹ç™»å½•çš„åŸç†(ä¸€æ¬¡ç™»å½•ï¼ŒäºŒçº§åŸŸåä¸‹ä¹Ÿå®ç°ç™»å½•)


## ğŸ˜Š git rebaseå’Œgit mergeçš„åŒºåˆ«

![åˆ†æ”¯.png](https://i.loli.net/2021/08/04/x3JsIgwpyLfbmuY.png)


![rebase.png](https://i.loli.net/2021/08/04/f7iJB64EmckAxWd.png)

rebase ä¼šæŠŠä½ å½“å‰åˆ†æ”¯çš„ commit æ”¾åˆ°å…¬å…±åˆ†æ”¯çš„æœ€åé¢

![merge.png](https://i.loli.net/2021/08/04/kY9aRmF78Iw5UnS.png)

merge ä¼šæŠŠå…¬å…±åˆ†æ”¯å’Œä½ å½“å‰çš„ commit åˆå¹¶åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªæ–°çš„ commit æäº¤

### rebase å’Œ merge åº”ç”¨åœºæ™¯çš„åŒºåˆ«


### å¦‚ä½•å°†å¤šä¸ªcommitåˆå¹¶åˆ°ä¸€ä¸ªcommitä¸Š
> æƒ…æ™¯ï¼šä¸Šæ¬¡commitæè¿°æœ‰è¯¯ï¼Œå¸Œæœ›commit messageåˆå¹¶åˆ°æœ€æ–°è¿™æ¬¡æäº¤ä¸­ï¼›æˆ–è€…å°†å¤šæ¬¡commitæäº¤åˆå¹¶ä¸ºcommit

``` bash
# ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡æäº¤ï¼Œç¼–è¾‘commitä¿¡æ¯
git commit --amend

# git rebase -i  è¿›å…¥åˆ° commitID ä¹‹å‰çš„äº¤äº’æ¨¡å¼
git rebase -i HEAD~2
```


## ğŸ˜Š gitå¦‚ä½•å›æ»š

```shell
# æŸ¥çœ‹commit id
git log
# å›é€€
git reset --hard "commit id"
# æ¨é€
git push origin "åˆ†æ”¯å"
```

```shell
# ç›´æ¥å›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬
git reset --hard HEAD^
```

## ğŸ˜Š git revert å’Œ git resetçš„åŒºåˆ«

```shell
# ç›®å‰çš„æäº¤çŠ¶æ€
42eae13 (HEAD -> master) ç¬¬å››æ¬¡ä¿®æ”¹
97ea0f9 ç¬¬ä¸‰æ¬¡ä¿®æ”¹
e50b7c2 ç¬¬äºŒæ¬¡ä¿®æ”¹
3a52650 ç¬¬ä¸€æ¬¡ä¿®æ”¹
```

å¦‚æœä½¿ç”¨`git reset --hard 97ea0f9`ï¼Œä½¿ç”¨resetå‘½ä»¤ï¼ŒGitä¼šæŠŠè¦`å›é€€ç‰ˆæœ¬ä¹‹åæäº¤çš„ä¿®æ”¹éƒ½åˆ é™¤æ‰`ã€‚è¦ä»ç¬¬å››æ¬¡ä¿®æ”¹å›é€€åˆ°ç¬¬ä¸€æ¬¡ä¿®æ”¹ï¼Œé‚£ä¹ˆä¼šåˆ é™¤ç¬¬äºŒã€ä¸‰ã€å››æ¬¡çš„ä¿®æ”¹ã€‚ã€æ³¨ï¼šè¿™é‡Œå¹¶ä¸æ˜¯çœŸæ­£çš„ç‰©ç†åˆ é™¤ã€‘

```shell
97ea0f9 (HEAD -> master) ç¬¬ä¸‰æ¬¡ä¿®æ”¹
e50b7c2 ç¬¬äºŒæ¬¡ä¿®æ”¹
3a52650 ç¬¬ä¸€æ¬¡ä¿®æ”¹
```

å¦‚æœå‘ç°ç¬¬ä¸‰æ¬¡ä¿®æ”¹æœ‰é”™è¯¯ï¼Œæƒ³è¦æ¢å¤ç¬¬ä¸‰æ¬¡ä¿®æ”¹ï¼Œå´è¦ä¿ç•™ç¬¬å››æ¬¡ä¿®æ”¹å‘¢ï¼Ÿ

`git revert -n 97ea0f9`

`git commit -m "æ¢å¤ç¬¬ä¸‰æ¬¡ä¿®æ”¹"`

GitæŠŠç¬¬ä¸‰æ¬¡ä¿®æ”¹ä»æäº¤ä¸­`å‰”é™¤(è¿˜åŸ)`äº†ï¼Œè¿˜`ä¿ç•™äº†ç¬¬å››æ¬¡ä¿®æ”¹`ï¼Œå¹¶ä¸”äº§ç”Ÿäº†æ–°çš„commit_idã€‚

```shell
33b8b30 (HEAD -> master) Revert "æ¢å¤ç¬¬ä¸‰æ¬¡ä¿®æ”¹"
42eae13 ç¬¬å››æ¬¡ä¿®æ”¹
97ea0f9 ç¬¬ä¸‰æ¬¡ä¿®æ”¹
e50b7c2 ç¬¬äºŒæ¬¡ä¿®æ”¹
3a52650 ç¬¬ä¸€æ¬¡ä¿®æ”¹
```

åœ¨ç¡®è®¤è¦å›æ»šçš„ç‰ˆæœ¬ä¹‹åï¼Œå¦‚æœåˆ«äººæ²¡æœ‰æœ€æ–°æäº¤ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ç”¨resetå‘½ä»¤è¿›è¡Œç‰ˆæœ¬å›é€€ï¼Œå¦åˆ™ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨revertå‘½ä»¤è¿›è¡Œè¿˜åŸä¿®æ”¹ï¼Œä¸èƒ½å½±å“åˆ°åˆ«äººçš„æäº¤ã€‚

## ğŸ˜Š gitåˆ é™¤è¿œç«¯çš„åˆ†æ”¯

```shell
git push origin --delete "åˆ†æ”¯å"
```

## ğŸ˜Š è¯´ä¸€è¯´commit hook

- "@commitlint/cli": "^8.3.5", "@commitlint/config-conventional": "^8.3.4", å¯¹commitçš„msgçš„æ ¡éªŒ
- huskyï¼Œä½¿ç”¨coomit-hook

```json
"husky": {
    "hooks": {
      "pre-commit": "npm run lint",
      "pre-push": "npm run test",
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS"
    }
},
```

## ğŸ˜Š sendBround å’Œ ajax çš„ä¼˜ç¼ºç‚¹

1. åœ¨é¡µé¢å…³é—­çš„æ—¶å€™ajaxå¯èƒ½ä¼š`ä¸ŠæŠ¥ä¸­æ­¢`ï¼Œå¯ä»¥ä½¿ç”¨`navigator.sendBeacon`, ä½†æ˜¯`navigator.sendBeacon`ä¸ä¼šè¿”å›æ˜¯å¦æˆåŠŸçš„ä¿¡æ¯
2. ç§»åŠ¨ç«¯è®¾å¤‡ä½¿ç”¨`visibilitychange`ï¼Œä½†æ˜¯safariä¸å…¼å®¹ä½¿ç”¨beforeunloadæ—¶é—´
  - é¿å…ä½¿ç”¨ unload å’Œ beforeunload
  - ä½¿ç”¨ unload (en-US) æˆ– beforeunload (en-US) äº‹ä»¶ä»¥åœ¨ä¼šè¯ç»“æŸæ—¶å‘é€ç»Ÿè®¡æ•°æ®ã€‚ç„¶è€Œè¿™æ˜¯ä¸å¯é çš„ï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼ˆå°¤å…¶æ˜¯ç§»åŠ¨è®¾å¤‡ï¼‰æµè§ˆå™¨ä¸ä¼šäº§ç”Ÿ unloadã€beforeunload æˆ– pagehide äº‹ä»¶
  ``` js
  document.addEventListener('visibilitychange', function logData() {
    if (document.visibilityState === 'hidden') {
      navigator.sendBeacon('/log', analyticsData);
    }
  });
  ```
  
## ajaxå’Œfetchçš„åŒºåˆ«

1. ajaxä½¿ç”¨xhr apiã€‚fetchä½¿ç”¨çš„fetch apiã€‚
2. fetchåŸºäºpromiseã€‚ajaxä½¿ç”¨promiseéœ€è¦å°è£…ã€‚


## redux mobx flux çš„åŒºåˆ«

