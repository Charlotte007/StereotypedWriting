## 1. å®ç°curry

> https://bigfrontend.dev/zh/problem/implement-curry

```js
const join = (a, b, c) => {
   return `${a}_${b}_${c}`
}

const curriedJoin = curry(join)

curriedJoin(1, 2, 3) // '1_2_3'

curriedJoin(1)(2, 3) // '1_2_3'

curriedJoin(1, 2)(3) // '1_2_3'

// å®ç°curry
const curry = (fn, ...initParams) => {
  return (...args) => {
    return ((params) => {
      return params.length >= fn.length ? fn(...params) : curry(fn, ...params) 
    })([ ...initParams, ...args])
  }
}
```

## 2. å®ç°æ”¯æŒplaceholderçš„curry()

> https://bigfrontend.dev/zh/problem/implement-curry-with-placeholder

```ts
/**
 * åˆå¹¶å‚æ•°ï¼ˆæ›¿æ¢å ä½ç¬¦ï¼‰
 */
function merge(params1, params2) {
  for (let i = 0; i < params1.length; i += 1) {
    if (params2.length) {
      if (typeof params1[i] === 'symbol') {
        const first = params2.shift()
        params1[i] = first
      }
    } else {
        break
    }
  }
  return [...params1, ...params2]
}

/**
 * @param { (...args: any[]) => any } fn
 * @returns { (...args: any[]) => any }
 */
function curry(fn, ...initParams) {
  return (...args) => {
    const params = merge([...initParams], [...args])
    return ((params) => {
      params = params.slice(0, fn.length)
      // åˆ¤æ–­æ˜¯å¦å¯ä»¥æ‰§è¡Œ
      const isCall = params.filter((item) => typeof item !== 'symbol').length >= fn.length
      return isCall ? fn(...params) : curry(fn, ...params) 
    })(params)
  }
}

curry.placeholder = Symbol()
```

## 3. å®ç°Array.prototype.flat()

> https://bigfrontend.dev/zh/problem/implement-Array-prototype.flat

```js
/**
 * @param { Array } arr
 * @param { number } depth
 * @returns { Array }
 */
function flat(arr, depth = 1) {
  const result = []
  if (depth) {
    let isExistArray = false;
    for (let i = 0; i < arr.length; i += 1) {
      const item = arr[i]
      if (Array.isArray(item)) {
        isExistArray = true
        result.push(...item)
      } else {
        result.push(item)
      }
    }
    if (isExistArray) {
      return flat(result, depth - 1)
    } else {
      return result
    }
  } else {
    return arr
  }
}
```

## 4. æ‰‹å†™throttle()

> https://bigfrontend.dev/zh/problem/implement-basic-throttle

```ts
/**
 * @param {Function} func
 * @param {number} wait
 */
function throttle(func, wait) {
  let timer
  let lastArgs
  return function (...param) {
    if (!timer) {
      func.call(this, ...param)
      timer = window.setTimeout(() => {
        lastArgs && func.call(this, ...lastArgs)
        lastArgs = null
        timer = null
      }, wait)
    } else {
      lastArgs = [...param]
    }
  }
}
```

## 6. æ‰‹å†™debounce()

> https://bigfrontend.dev/zh/problem/implement-basic-debounce

```ts
/**
 * @param {Function} func
 * @param {number} wait
 */
function debounce(func, wait) {
  let timer
  return function (...param) {
    function clear() {
      window.clearTimeout(timer)
      timer = null
    }
    function run() {
      timer = window.setTimeout(() => {
        func.call(this, ...param)
        clear()
      }, wait)
    }
    if (!timer) {
      run()
    } else {
      clear()
      run()
    }
  }
}
```


## 8. æ‰‹å†™shuffle()éšæœºæ‰“ä¹±ä¸€ä¸ªæ•°ç»„ï¼ˆå®ç°ä¸€ä¸ªæ´—ç‰Œç®—æ³•ï¼‰

> https://bigfrontend.dev/zh/problem/can-you-shuffle-an-array

> å¸¸è§„çš„`const randomIndex = Math.floor(Math.random() * arr.length)`ç”Ÿæˆéšæœºç´¢å¼•çš„æ–¹å¼ä¸å¤Ÿéšæœº

```js
/**
  * @param {any[]} arr
  */
function shuffle(arr) {
  for (let i = 0; i < arr.length; i += 1) {
    const j = i + Math.floor(Math.random() * (arr.length - 1));
    [arr[i], arr[j]] = [arr[j], arr[i]]
  }
  return arr
}
```

## 9. è§£å¯†æ¶ˆæ¯

> https://bigfrontend.dev/zh/problem/decode-message

```ts
/**
 * @param {string[][]} message
 * @return {string}
 */
function decode(message) {
  // ä¸ºç©ºçš„åˆ¤æ–­
  if (!message.length || !message[0].length) {
    return ''
  }

  let power = true
  let str = ''
  let i = 0
  let j = 0
  let direction = 'LowerRight' // LowerRight | UpperRight
  let w = message[0].length
  let h = message.length

  function lowerRight() {
    if (i + 1 < h && j + 1 < w) {
      i = i + 1
      j = j + 1
    } else {
      if (i - 1 > 0 && j + 1 < w) {
        direction = 'UpperRight'
        i = i - 1
        j = j + 1
      } else {
        power = false
      }
    }
  }

  function upperRight() {
    if (i - 1 > 0 && j + 1 < w) {
      i = i - 1
      j = j + 1
    } else {
      if (i + 1 < h && j + 1 < w) {
        direction = 'LowerRight'
        i = i + 1
        j = j + 1
      } else {
        power = false
      }
    }
  }

  while (power) {
    str += message[i][j]
    if (direction === 'LowerRight') {
      lowerRight()
    } else if (direction === 'UpperRight') {
      upperRight()
    }
  }
  return str
}
```
## 10. æ‰¾å‡ºç¬¬ä¸€ä¸ªä¸è‰¯ç‰ˆæœ¬

> https://bigfrontend.dev/zh/problem/first-bad-version

> ç®€å•çš„äºŒåˆ†æŸ¥æ‰¾

```ts
/*
 type TypIsBad = (version: number) => boolean
 */

/**
 * @param {TypIsBad} isBad 
 */
function firstBadVersion(isBad) {
  return (version) => {
    let start = 0
    let end = version
    let result = isBad(version) ? version : -1

    while (end >= start) {
      let midd = Math.floor((start + end) / 2)
      if (isBad(midd)) {
        // å¦‚æœæ˜¯åçš„
        end = midd - 1
        result = midd
      } else {
        // å¦‚æœæ˜¯å¥½çš„
        start = midd + 1
      }
    }
    return result
  }
}
```

## 11. ä»€ä¹ˆæ˜¯Composition?å®ç°pipe()

> https://bigfrontend.dev/zh/problem/what-is-composition-create-a-pipe

> å®ç°ä¸€ä¸ªç®¡é“å‡½æ•°

```ts
/**
 * @param {Array<(arg: any) => any>} funcs 
 * @return {(arg: any) => any}
 */
function pipe(funcs) {
	return function (arg) {
		let param = arg
		for (let i = 0; i < funcs.length; i += 1) {
			const func = funcs[i]
			param = func(param)
		}
		return param
	}
}
```

## ğŸ˜­ 12. å®ç° Immutability helper

> https://bigfrontend.dev/zh/problem/implement-Immutability-helper

> Reactæ–‡æ¡£: https://reactjs.org/docs/update.html

> æœ‰ç‚¹éš¾è¿™é¢˜ğŸ˜…

```ts
/**
 * @param {any} data
 * @param {Object} command
 */
function update(data, command) {
  const collection = {$push: true, $set: true, $merge: true, $apply: true}

  const handlePush = function (command, keys) {
    let arr = data
    for (let i = 0; i < keys.length; i += 1) {
      arr = arr[keys[i]]
    }
    if (Array.is)
  }

  const handleSet = function () {
  }

  const handleMerge = function () {
  }

  const handleApply = function () {
  }

  const job = function (keys, command) {
    for (let key in command) {
      if (collection[key]) {
        switch (key) {
          case '$push':
            handlePush(command[key], keys)
            break
          case '$set':
            break
          case '$merge':
            break
          case '$apply':
            break
        }
      } else {
        job([...keys, key], command.key)
      }
    }
  }

  job([], command)

  return {...data}
}
```

## 13. åˆ©ç”¨æ ˆ(Stack)åˆ›å»ºé˜Ÿåˆ—(Queue)

> https://bigfrontend.dev/zh/problem/implement-a-queue-by-using-stack

> å¯ä»¥ç”¨ä¸¤ä¸ªStackå®ç°Queue

> æ›´ç®€å•çš„æ–¹æ³•æ˜¯ï¼Œæ¯ä¸€æ¬¡enqueueæ—¶éƒ½åç€å­˜ã€‚

```ts

class Stack {
  constructor () {
    this.stack = []
  }
  push(element) {
    this.stack.push(element)
  }
  peek() {
    return this.stack[this.stack.length - 1]
  }
  pop() {
    return this.stack.pop()
  }
  size() {
    return this.stack.length
  }
}

// ä½¿ç”¨Stackå®ç°Queue
class Queue {
  constructor () {
    this.enqueueStack = new Stack()
    this.dequeueStack = new Stack()
  }

  _enqueueSyncDequeue () {
    const dequeueTemp = new Stack()
    const enqueueTemp = new Stack()
    while (this.enqueueStack.size()) {
      const p = this.enqueueStack.pop()
      dequeueTemp.push(p)
      enqueueTemp.push(p)
    }
    while (enqueueTemp.size()) {
      this.enqueueStack.push(enqueueTemp.pop())
    }
    this.dequeueStack = dequeueTemp
  }

  _dequeueSyncEnqueue () {
    const dequeueTemp = new Stack()
    const enqueueTemp = new Stack()
    while (this.dequeueStack.size()) {
      const p = this.dequeueStack.pop()
      dequeueTemp.push(p)
      enqueueTemp.push(p)
    }
    while (dequeueTemp.size()) {
      this.dequeueStack.push(dequeueTemp.pop())
    }
    this.enqueueStack = enqueueTemp
  }

  enqueue(element) { 
    this.enqueueStack.push(element)
    this._enqueueSyncDequeue()
  }

  peek() { 
    return this.dequeueStack.peek()
  }
  
  dequeue() {
    const p = this.dequeueStack.pop()
    this._dequeueSyncEnqueue()
    return p
  }

  size() { 
    return this.enqueueStack.size()
  }
}

// æ”¹è¿›ç‰ˆ
class Queue {
  constructor () {
    this.stack = new Stack()
    this.queue = new Stack()
  }

  enqueue(element) { 
    while (this.queue.size()) {
      this.stack.push(this.queue.pop())
    }
    this.queue.push(element)
    while (this.stack.size()) {
      this.queue.push(this.stack.pop())
    }
  }

  peek() { 
    return this.queue.peek()
  }
  
  dequeue() {
    return this.queue.pop()
  }

  size() { 
    return this.queue.size()
  }
}
```

## 14. å®ç°`memo()`

> https://bigfrontend.dev/zh/problem/implement-general-memoization-function

```ts
/**
 * @param {Function} func
 * @param {(args:[]) => string }  [resolver] - cache key generator
 */
function memo(func, resolver) {
  const map = new Map();
  return function (...params) {
    let key
    if (typeof resolver === 'function') {
      key = resolver(...params)
    } else {
      key = [...params].join('-')
    }
    if (map.has(key)) {
      return map.get(key)
    } else {
      const val = func.apply(this, [...params])
      map.set(key, val)
      return val
    }
  }
}
```
## 15. å®ç°ç±»ä¼¼jQueryçš„DOM wrapper

> https://bigfrontend.dev/zh/problem/implement-a-simple-DOM-wrapper-to-support-method-chaining-like-jQuery

```ts

/**
 * @param {HTMLElement} el - element to be wrapped
 */
function $(el) {
  el.css = function (key, value) {
    el.style[key] = value
    return el
  }

  return el
}
```

## 16. å®ç°ä¸€ä¸ªEvent Emitter

> https://bigfrontend.dev/zh/problem/create-an-Event-Emitter

```ts
// please complete the implementation
class EventEmitter {
  constructor () {
    this.map = {}
  }

  subscribe(eventName, callback) {
    const event = {eventName, callback}
    const that = this
    if (this.map[eventName]) {
      this.map[eventName].push(event)
    } else {
      this.map[[eventName]] = [event]
    }

    return {
      release () {
        that.map = {
          ...that.map,
          [eventName]: that.map[eventName].filter((e) => e !== event)
        }
      }
    }
  }
  
  emit(eventName, ...args) {
  	if (this.map[eventName]) {
      this.map[eventName].forEach((event) => {
        const { callback } = event
        callback(...args)
      })
    }
  }
}
```

## 17. å®ç°ä¸€ä¸ªDOM element store

> https://bigfrontend.dev/zh/problem/create-a-simple-store-for-DOM-node

> æ³¨æ„æ—¶é—´ç©ºé—´å¤æ‚åº¦,hasæ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦åº”è¯¥æ˜¯o(1)

> å¦‚ä½•å®ç°ä¸€ä¸ªMap polyfill

```ts
class NodeStore {
  constructor () {
    this.map = {}
  }

  /**
  * @param {Node} node
  * @param {any} value
  */
  set(node, value) {
    if (!node.__mapKey__) {
      node.__mapKey__ = Symbol()
      this.map[node.__mapKey__] = value
    } else {
      this.map[node.__mapKey__] = value
    }
  }

 /**
  * @param {Node} node
  * @return {any}
  */
  get(node) {
    return this.map[node.__mapKey__]
  }
 
 /**
  * @param {Node} node
  * @return {Boolean}
  */
 has(node) {
   return !!node.__mapKey__ && node.__mapKey__ in this.map
 }
}
```

## 18. ä¼˜åŒ–ä¸€ä¸ªfunction

> https://bigfrontend.dev/zh/problem/improve-a-function


ä¼˜åŒ–å‰çš„æ—¶é—´å¤æ‚åº¦O(m * n)

```ts
// itemsæ˜¯ä¸€ä¸ªarray
// åŒ…å«çš„å…ƒç´ æœ‰ >=3 ä¸ªå±æ€§

let items = [
  {color: 'red', type: 'tv', age: 18}, 
  {color: 'silver', type: 'phone', age: 20},
  {color: 'blue', type: 'book', age: 17}
] 

// ä¸€ä¸ªç”±keyå’Œvalueç»„æˆçš„array
const excludes = [ 
  {k: 'color', v: 'silver'}, 
  {k: 'type', v: 'tv'}, 
  ...
] 

function excludeItems(items, excludes) { 
  excludes.forEach( pair => { 
    items = items.filter(item => item[pair.k] === item[pair.v])
  })
 
  return items
} 
```

ä¼˜åŒ–åï¼š

```ts
function excludeItems(items, excludes) { 
  const excludesMap = {}
  excludes.forEach(({k, v}) => {
    if (excludesMap[k]) {
      excludesMap[k].add(v)
    } else {
      excludesMap[k] = new Set()
      excludesMap[k].add(v)
    }
  })

  return items.filter((item) => {
    return Object.keys(item).every((key) => {
      if (excludesMap[key]) {
        return !excludesMap[key].has(item[key])
      }
      return true
    })
  })
} 
```

## 19. ç›¸åŒç»“æ„çš„DOM treeä¸Šé¢å¯»æ‰¾å¯¹åº”çš„èŠ‚ç‚¹

> https://bigfrontend.dev/zh/problem/find-corresponding-node-in-two-identical-DOM-tree

```ts
/**
 * @param {HTMLElement} rootA
 * @param {HTMLElement} rootB - rootA and rootB are clone of each other
 * @param {HTMLElement} nodeA
 */
const findCorrespondingNode = (rootA, rootB, target) => {
  const paths = []
  let isSearchEnd = false
  let targetB = rootB

  const find = (node, index) => {
    if (index !== undefined && !isSearchEnd) {
      paths.push(index)
    }
    if (node !== target) {
      const children = [...node.children]
      children.forEach((item, index) => {
        find(item, index)
      })
      if (!isSearchEnd) {
        paths.pop()
      }
    } else {
      isSearchEnd = true
    }
  }

  find(rootA)

  if (paths.length !== 0) {
    while (paths.length) {
      const index = paths.shift()
      targetB = [...targetB.children][index]
    }
  }

  return targetB
}
```

## 20. æ£€æµ‹ data type

> https://bigfrontend.dev/zh/problem/detect-data-type-in-JavaScript

```ts
/**
 * @param {any} data
 * @return {string}
 */
function detectType(data) {
  if(data instanceof FileReader) {
    return 'object'
  }
  const type = Object.prototype.toString.call(data);
  return /^\[object\s+([A-Za-z]+)\]$/.exec(type)[1].toLocaleLowerCase()
}
```

## ğŸ˜­ 21. æ‰‹å†™JSON.stringify()

> https://bigfrontend.dev/zh/problem/implement-JSON-stringify

```ts
```

## ğŸ˜­ 22. æ‰‹å†™JSON.parse()

> https://bigfrontend.dev/zh/problem/implement-JSON-parse

```ts
```
## 23. å®ç°ä¸€ä¸ªsum()æ–¹æ³•

> https://bigfrontend.dev/zh/problem/create-a-sum

```ts
/**
 * @param {number} num
 */
function sum(num) {
  const fn = function (arg) {
    return sum(num + arg)
  }
  fn.toString = function () {
    return num
  }
  return fn
}
```

## 24. ç”¨JavaScriptæ‰‹å†™ä¸€ä¸ªPriority Queue

> https://bigfrontend.dev/zh/problem/create-a-priority-queue-in-JavaScript

```ts

// complete the implementation
class PriorityQueue {
  /**
   * @param {(a: any, b: any) => -1 | 0 | 1} compare - 
   * compare function, similar to parameter of Array.prototype.sort
   */
  constructor(compare) {
    this.compare = compare;
  }

  /**
   * return {number} amount of items
   */
  size() {

  }

  /**
   * returns the head element
   */
  peek() {

  }

  /**
   * @param {any} element - new element to add
   */
  add(element) {
   
  }

  /**
   * remove the head element
   * @return {any} the head element
   */
  poll() {
    
  }
}
```
## 25. æ›´æ–°æ•°ç»„çš„é¡ºåº

> https://bigfrontend.dev/zh/problem/reorder-array-with-new-indexes

```js
/**
 * @param {any[]} items
 * @param {number[]} newOrder
 * @return {void}
 */
// ä¸å®ç”¨é¢å¤–ç©ºé—´
function sort(items, newOrder) {
  // ä½¿ç”¨ç®€å•çš„å†’æ³¡æ’åº
  for (let i = 0; i < items.length; i += 1) {
    for (let j = i + 1; j < items.length; j += 1) {
      if (newOrder[i] > newOrder[j]) {
        // æ›´æ–°itemsçš„é¡ºåºä»¥åŠnewOrderçš„é¡ºåº
        let otemp = newOrder[j]
        let itemp = items[j]
        newOrder[j] = newOrder[i]
        newOrder[i] = otemp
        items[j] = items[i]
        items[i] = itemp
      }
    }
  }
  return items
}

```

## 26. å®ç°Object.assign()

> https://bigfrontend.dev/zh/problem/implement-object-assign

```ts
/**
 * @param {any} target
 * @param {any[]} sources
 * @return {object}
 */
 function objectAssign(target, ...sources) {
  if (target === null || target === undefined) {
    throw new Error()
  } 
  if (typeof target === 'number') {
    target = new Number(target)
  }
  if (typeof target === 'boolean') {
    target = new Boolean(target)
  }
  if (typeof target === 'string') {
    target = new String(target)
  }
  sources.forEach(source => {
    if (source === undefined || source === null) {
      return
    }
    Object.defineProperties(
      target,
      Object.getOwnPropertyDescriptors(source)
    )
  })
  return target
}
```

## 27. å®ç°completeAssign()

> https://bigfrontend.dev/zh/problem/implement-completeAssign

> https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty

```ts
function completeAssign(target, ...sources) {
  if (target === null || target === undefined) {
    throw new Error()
  } 
  if (typeof target === 'number') {
    target = new Number(target)
  }
  if (typeof target === 'boolean') {
    target = new Boolean(target)
  }
  if (typeof target === 'string') {
    target = new String(target)
  }
  sources.forEach(source => {
    if (source === undefined || source === null) {
      return
    }
    Object.defineProperties(
      target,
      Object.getOwnPropertyDescriptors(source)
    )
  })
  return target
}
```

## 28. å®ç°clearAllTimeout()

> https://bigfrontend.dev/zh/problem/implement-clearAllTimeout

```ts
const beforeSetTimeout = window.setTimeout

window.timers = new Set()

// é‡å†™setTimeout
window.setTimeout = function (handler, timeout, ...arg) {
  const that = this
  const timer = beforeSetTimeout(
    function (...arg) {
      handler.apply(that, [...arg])
    },
    timeout,
    ...arg
  )
  window.timers.add(timer)
  return timer
}


/**
 * cancel all timer from window.setTimeout
 */
function clearAllTimeout() {
  window.timers.forEach((timer) => {
    window.clearTimeout(timer)
  })
}
```

## 29. å®ç°async helper - `sequence()`

> https://bigfrontend.dev/zh/problem/implement-async-helper-sequence

```ts
/*
type Callback = (error: Error, data: any) => void

type AsyncFunc = (
   callback: Callback,
   data: any
) => void
*/

function promisify(func) {
  return function (num) {
    return new Promise(function(resolve, reject) {
      func(function (err, data) {
        if (err) {
          reject(err)
        } else {
          resolve(data)
        }
      }, num)
    })
  }
}

/**
 * @param {AsyncFunc[]} funcs
 * @return {(callback: Callback) => void}
 */
function sequence(funcs) {
  funcs = funcs.map(func => promisify(func))
  return async function (callback, data) {
    try {
      for (let i = 0; i < funcs.length; i += 1) {
        data = await funcs[i](data)
      }
      callback(undefined, data)
    } catch (error) {
      callback(error, undefined)
    }
  }
}
```

## 30. å®ç°async helper - `parallel()`

> https://bigfrontend.dev/zh/problem/implement-async-helper-parallel

```ts
/*
type Callback = (error: Error, data: any) => void

type AsyncFunc = (
   callback: Callback,
   data: any
) => void

*/

function promisify(func) {
  return function (...args) {
    return new Promise(function(resolve, reject) {
      func(function (err, data) {
        if (err) {
          reject(err)
        } else {
          resolve(data)
        }
      }, ...args)
    })
  }
}

/**
 * @param {AsyncFunc[]} funcs
 * @return {(callback: Callback) => void}
 */
function parallel(funcs){
  funcs = funcs.map(func => promisify(func))
  return function (callback, data) {
    let count = 0
    let handleError = false
    const result = []
    for (let i = 0; i < funcs.length; i += 1) {
      funcs[i](data).then(function (res) {
        result[i] = res
        count += 1
        if (count === funcs.length) {
          callback(undefined, result)
        }
      }).catch(function (err) {
        if (!handleError) {
          callback(err, undefined)
          handleError = true
        }
      })
    }
  }
}
```

## 31. å®ç°async helper - `race()`

> https://bigfrontend.dev/zh/problem/implement-async-helper-race

```ts
/*
type Callback = (error: Error, data: any) => void

type AsyncFunc = (
   callback: Callback,
   data: any
) => void

*/
function promisify(func) {
  return function (...args) {
    return new Promise(function(resolve, reject) {
      func(function (err, data) {
        if (err) {
          reject(err)
        } else {
          resolve(data)
        }
      }, ...args)
    })
  }
}

/**
 * @param {AsyncFunc[]} funcs
 * @return {(callback: Callback) => void}
 */
function race(funcs){
  funcs = funcs.map(func => promisify(func))
  return function (callback, data) {
    let handleEnd = false
    for (let i = 0; i < funcs.length; i += 1) {
      funcs[i](data).then(function (res) {
        if (!handleEnd) {
          callback(undefined, res)
        }
        handleEnd = true
      }).catch(function (err) {
        if (!handleEnd) {
          callback(err, undefined)
        }
        handleEnd = true
      })
    }
  }
}
```

## 32. å®ç°`Promise.all()`

> https://bigfrontend.dev/zh/problem/implement-Promise-all

```ts
/**
 * @param {Array<any>} promises - notice input might have non-Promises
 * @return {Promise<any[]>}
 */
function all(promises) {
  return new Promise((resolve, reject) => {
    if (!promises.length) {
      return resolve([])
    }
    const result = [];
    let count = 0;
    for (let i = 0; i < promises.length; i++) {
      const promise = promises[i] instanceof Promise ? promises[i] : Promise.resolve(promises[i])
      promise.then((res) => {
        result[i] = res
        count += 1
        if (count === promises.length) {
          resolve(result)
        }
      }).catch((err) => {
        reject(err)
      })
    }
  })
}
```
## 33. å®ç°`Promise.allSettled()`

> https://bigfrontend.dev/zh/problem/implement-Promise-allSettled

```ts
/**
 * @param {Array<any>} promises - notice that input might contains non-promises
 * @return {Promise<Array<{status: 'fulfilled', value: any} | {status: 'rejected', reason: any}>>}
 */
function allSettled(promises) {
  return new Promise((resolve, reject) => {
    if (!promises.length) {
      return resolve([])
    }
    const result = [];
    let count = 0;
    for (let i = 0; i < promises.length; i++) {
      const promise = promises[i] instanceof Promise ?
        promises[i] :
        Promise.resolve(promises[i])
      promise.then((res) => {
        result[i] = {status:"fulfilled",value: res}
        count += 1
        if (count === promises.length) {
          resolve(result)
        }
      }).catch((err) => {
        result[i] = {status:"rejected",reason: err}
        count += 1
        if (count === promises.length) {
          resolve(result)
        }
      })
    }
  })
}
```
## 34. å®ç°`Promise.any()`

> https://bigfrontend.dev/zh/problem/implement-Promise-any

```ts
/**
 * @param {Array<Promise>} promises
 * @return {Promise}
 */
function any(promises) {
  return new Promise((resolve, reject) => {
    if (!promises.length) {
      return reject(
        new AggregateError(
          'No Promise in Promise.any was resolved', 
          []
        )
      )
    }
    const errors = [];
    let count = 0;
    for (let i = 0; i < promises.length; i += 1) {
      const promise = promises[i] instanceof Promise ? promises[i] : Promise.resolve(promises[i])
      promise.then((res) => {
        resolve(res)
      }).catch((err) => {
        errors[i] = err
        count += 1
        if (count === promises.length) {
          reject(
            new AggregateError(
              'No Promise in Promise.any was resolved', 
              errors
            )
          )
        }
      })
    }
  })
}
```


## 35. å®ç°`Promise.race()`

> https://bigfrontend.dev/zh/problem/implement-Promise-race

```ts
/**
 * @param {Array<Promise>} promises
 * @return {Promise}
 */
function race(promises) {
  return new Promise((resolve, reject) => {
    if (promises.length) {
      for (let i = 0; i < promises.length; i += 1) {
        const promise = promises[i] instanceof Promise ?
          promises[i]
          :
          Promise.resolve(promises[i])
        promise.then((res) => {
          resolve(res)
        }).catch((err) => {
          reject(err)
        })
      }
    }
  })
}
```

## 36. å®ç°ä¸€ä¸ª fake timer(setTimeout)

> https://bigfrontend.dev/zh/problem/create-a-fake-timer

```ts
```

## 37. æ‰‹å†™Binary Search (unique)

> https://bigfrontend.dev/zh/problem/implement-Binary-Search-Unique

```ts
```

## 38. å®ç°`jest.spyOn()`

> https://bigfrontend.dev/zh/problem/implement-spyOn

```ts
/**
 * @param {object} obj
 * @param {string} methodName
 */
function spyOn(obj, methodName) {
  if (!(obj[methodName] instanceof Function)) {
    throw new Error()
  }

  const before = obj[methodName]
  const calls = []

  obj[methodName] = function (...args) {
    calls.push([...args])
    before.call(this, ...args)
  }

  return {
    calls
  }
}
```

## 39. æ‰‹å†™range()

> https://bigfrontend.dev/zh/problem/implement-range

```ts
/**
 * @param {integer} from
 * @param {integer} to
 */
function range(from, to) {
  const result = []
  while (from <= to) {
    result.push(from)
    from += 1
  }
  return result
}
```

## 40. æ‰‹å†™å†’æ³¡æ’åº

> https://bigfrontend.dev/zh/problem/implement-Bubble-Sort

> å†’æ³¡æ’åºï¼Œå±äºç¨³å®šçš„æ’åºï¼Œç©ºé—´å¤æ‚åº¦O(n), æ—¶é—´å¤æ‚åº¦O(n^2)

```ts
/**
 * @param {number[]} arr
 */
 function bubbleSort(arr) {
  for (let i = 0; i < arr.length; i += 1) {
    for (let j = i + 1; j < arr.length; j += 1) {
      if (arr[i] > arr[j]) {
        [arr[i], arr[j]] = [arr[j], arr[i]]
      }
    }
  }
  return arr
}
```

## 41. æ‰‹å†™å½’å¹¶æ’åº

> https://bigfrontend.dev/zh/problem/implement-Merge-Sort

> åˆ†æ²»æ³•

```ts
```

## 43. æ‰‹å†™å¿«é€Ÿæ’åº

> https://bigfrontend.dev/zh/problem/implement-Quick-Sort

```ts
// Note: éœ€è¦ç›´æ¥åœ¨åŸæ•°ç»„ä¸Šä¿®æ”¹
/**
 * @param {number[]} arr
 */
function quickSort(arr) {
  if (arr.length <= 1) {
    return arr
  }

  const referenceValue = arr[0]
  const max = []
  const min = []

  for (let i = 1; i < arr.length; i += 1) {
    if (arr[i] >= referenceValue) {
      max.push(arr[i])
    } else {
      min.push(arr[i])
    }
  }

  return quickSort(min).concat(referenceValue, quickSort(max))
}

// åŸåœ°ä¿®æ”¹
/**
 * @param {number[]} arr
 */
function quickSort(arr) {
  if (arr.length <= 1) {
    return arr
  }

  const referenceValue = arr[0]
  let max = []
  let min = []

  for (let i = 1; i < arr.length; i += 1) {
    if (arr[i] >= referenceValue) {
      max.push(...arr.splice(i,1))
    } else {
      min.push(...arr.splice(i,1))
    }
    i -= 1
  }

  min = quickSort(min)
  max = quickSort(max)

  while (max.length) {
    arr.push(max.shift())
  }

  while (min.length) {
    arr.unshift(min.pop())
  }

  return arr
}
```

## 44. æ‰‹å†™é€‰æ‹©æ’åº

> https://bigfrontend.dev/zh/problem/implement-Selection-Sort

```ts
```

## 53. å®ç°middleware

> https://bigfrontend.dev/zh/problem/create-a-middleware-system

```
```

## 55. HTMLå­—ç¬¦ä¸²ä¸­é«˜äº®å…³é”®å­—

> https://bigfrontend.dev/zh/problem/highlight-keywords-in-HTML-string

## 85. å®ç° `_.get()`

> https://bigfrontend.dev/zh/problem/implement-lodash-get

```ts
```

## 90. å®ç°`instanceof`

> https://bigfrontend.dev/zh/problem/write-your-own-instanceof

## 91. åè½¬äºŒå‰æ ‘

> https://bigfrontend.dev/zh/problem/invert-a-binary-tree

## 92. PromiseèŠ‚æµ

> https://bigfrontend.dev/zh/problem/throttle-Promises

## 94. å®ç°`Object.create`

> https://bigfrontend.dev/zh/problem/implement-your-own-Object-create

```ts
/**
 * @param {any} proto
 * @return {object}
 */
function myObjectCreate(proto) {
  if (!(proto instanceof Object)) {
    throw new Error()
  }
  const obj = {}
  obj.__proto__ = proto
  return obj
}

/**
 * @param {any} proto
 * @return {object}
 */
function myObjectCreate(proto) {
  if (!(proto instanceof Object)) {
    throw new Error()
  }
  function Constructor () {}
  Constructor.prototype = proto
  return new Constructor();
}
```

## 95. å®ç° String.prototype.trim()

> https://bigfrontend.dev/zh/problem/implement-String-prototype-trim

```js
/**
 * @param {string} str
 * @return {string}
 */
function trim(str) {
  return str.replace(/^\s+|\s+$/g, '')
}
```
## 97. å‹ç¼©å­—ç¬¦ä¸²

> https://bigfrontend.dev/zh/problem/compress-a-string

```js
/**
 * @param {string} str
 * @return {string}
 */
function compress(str) {
  let s = str[0]
  let p = str[0]
  let n = 1

  for (let i = 1; i < str.length; i += 1) {
    if (str[i] === p) {
      n += 1
      if (n > 2) {
        let arr = s.split('')
        arr.pop()
        s = `${arr.join('')}${n}`
      } else {
        s = `${s}${n}`
      }
    } else {
      p = str[i]
      n = 1
      s = `${s}${str[i]}`
    }
  }

  return s
}
```

## 130. åˆ›å»ºLazyMan()

> https://bigfrontend.dev/zh/problem/create-lazyman

```ts
// interface Laziness {
//   sleep: (time: number) => Laziness
//   sleepFirst: (time: number) => Laziness
//   eat: (food: string) => Laziness
// }

function sleep (time) {
  return new Promise(function (resolve) {
    setTimeout(() => {
      resolve()
    }, time)
  })
}

/**
 * @param {string} name
 * @param {(log: string) => void} logFn
 * @returns {Laziness}
 */
function LazyMan(name, logFn) {

  const queue = [() => {
    logFn(`Hi, I'm ${name}.`)
  }]
  let update = false

  const handleQueue = function () {
    update = true
    if (update) {
      Promise.resolve().then(async function () {
        update = false
        for (let i = 0; i < queue.length; i += 1) {
          await queue[i]()
        }
      })
    }
  }

  const laziness = {
    sleep (time) {
      queue.push(async () => {
        await sleep(time * 1000)
        logFn(time > 1 ? `Wake up after ${time} seconds.` : `Wake up after ${time} second.`)
      })
      if (!update) {
        handleQueue()
      }
      return laziness
    },
    sleepFirst (time) {
      queue.unshift(async () => {
        await sleep(time * 1000)
        logFn(time > 1 ? `Wake up after ${time} seconds.` : `Wake up after ${time} second.`)
      })
      if (!update) {
        handleQueue()
      }
      return laziness
    },
    eat (food) {
      queue.push(() => {
        logFn(`Eat ${food}.`)
      })
      if (!update) {
        handleQueue()
      }
      return laziness
    }
  }

  if (!update) {
    handleQueue()
  }

  return laziness
}
```
## 131. å®ç°_.chunk()

> https://bigfrontend.dev/zh/problem/implement-lodash-chunk

```ts
/** 
 * @param {any[]} items
 * @param {number} size
 * @returns {any[][]}
 */
function chunk(items, size) {
  if (size === 0 || items.length === 0) {
    return []
  }

  const result = []

  while (items.length) {
    result.push(items.splice(0, size))
  }
  
  return result
}
```
## 138. å·²æ’åºæ•°ç»„çš„äº¤é›†

> https://bigfrontend.dev/zh/problem/intersection-of-two0-sorted-Arrays

ä½¿ç”¨hashçš„æ–¹æ³•ï¼š

```ts
/**
 * @param {number[]} arr1 - integers
 * @param {number[]} arr2 - integers
 * @returns {number[]}
 */
function intersect(arr1, arr2) {
  const hash = {}
  const result = []
  
  for (let i = 0; i < arr1.length; i += 1) {
    const key = arr1[i]
    if (!hash[key]) {
      hash[key] = 1
    } else {
      hash[key] += 1
    }
  }

  for (let i = 0; i < arr2.length; i += 1) {
    const key = arr2[i]
    if (hash[key]) {
      hash[key] -= 1
      result.push(key)
    }
  }

  return result
}
```

ä½¿ç”¨åŒæŒ‡é’ˆ:

```ts
/**
 * @param {number[]} arr1 - integers
 * @param {number[]} arr2 - integers
 * @returns {number[]}
 */
function intersect(arr1, arr2) {
  const result = []
  let pointer1 = 0
  let pointer2 = 0
  
  while (pointer1 < arr1.length && pointer2 < arr2.length) {
    if (arr1[pointer1] === arr2[pointer2]) {
      result.push(arr1[pointer1])
      pointer1 += 1
      pointer2 += 1
    } else if (arr1[pointer1] > arr2[pointer2]) {
      pointer2 += 1
    } else if (arr1[pointer1] < arr2[pointer2]) {
      pointer1 += 1
    }
  }
  
  return result
}
```

## 143. Virtual DOM IV - JSX 1

> https://bigfrontend.dev/zh/problem/virtual-dom-iv-jsx-1

```ts
```

## 144. åºåˆ—åŒ–å’Œååºåˆ—åŒ–JSONä¸æ”¯æŒçš„æ•°æ®ç±»å‹

> https://bigfrontend.dev/zh/problem/serialize-and-deserialize-data-types-not-supported-in-JSON

## 145. æœ€å¤šé‡å¤å‡ºç°çš„å­—ç¬¦

> https://bigfrontend.dev/zh/problem/most-frequently-occurring-character

```js
function count(str: string): string | string[] {
  const map = {}
  let result = []
  for (let i = 0; i < str.length; i += 1) {
    if (!map[str[i]]) {
      map[str[i]] = 1
    } else {
      map[str[i]] += 1
    }
  }
  const max = Math.max(...Object.values(map))
  for (let key in map) {
    if (map[key] === max) {
      result.push(key)
    }
  }

  return result.length > 1 ? result : result[0]
}
```

## 146. å®ç°Array.prototype.reduce()

> https://bigfrontend.dev/zh/problem/implement-Array-prototype-reduce

## ğŸ˜­ 147. å–çŸ³å¤´

> https://bigfrontend.dev/zh/problem/pickup-the-stones

> è¿™é“é¢˜ç›®æ²¡æœ‰å¤ªæƒ³æ˜ç™½

```ts
function canWinStonePicking(n) {
  if (n === 0) return null
  if (n === 1) return 'B'
  if (n === 2) return 'A'

  const firstMove = new Map([
    [1, false],
    [2, true]
  ])
  const backhand = new Map([
    [1, true],
    [2, false]
  ])

  for (let i = 3; i <= n; i += 1) {
    firstMove.set(i, (backhand.get(i-2) || backhand.get(i-1)))
    backhand.set(i, (firstMove.get(i-2) && firstMove.get(i-1)))
  }

  return firstMove.get(n) ? 'A' : backhand.get(n) ? 'B' : null
}
```

## 148. åˆ›å»ºä¸€ä¸ªcounterå¯¹è±¡

> https://bigfrontend.dev/zh/problem/create-a-counter-object

```ts
function createCounter() {
  const obj = { _count: 0 }
  return Object.defineProperties(obj, {
    count: {
      get () {
        const r = obj._count
        obj._count += 1
        return r
      }
    }
  })
}
```

## 149. interpolation

> https://bigfrontend.dev/zh/problem/interpolation

```ts
function t(translation, data = {}) {
  return translation.replace(/{{(.*?)}}/g, (_, key) => data[key] || '')
}
```

## 150. Virtual DOM V - JSX 2

> https://bigfrontend.dev/zh/problem/virtual-dom-v-jsx-2

```ts
```

## 151. å®ç°Array.prototype.map()

> https://bigfrontend.dev/zh/problem/implement-Array-prototype-map

> Array.prototype.map()å¯ä»¥æŒ‡å®šcallbackæ‰§è¡Œæ—¶çš„this

```ts
Array.prototype.myMap = function(callback, thisArg) {
  const result = []
  const that = thisArg || this
  this.forEach(function (item, i) {
    result[i] = callback.call(that, item, i, that)
  })
  return result
}
```

## 152. æ‰¾åˆ°æœ€å¤§çš„å‰kä¸ªå…ƒç´ 

> https://bigfrontend.dev/zh/problem/top-k-elements

> å †æ’åºï¼Œåˆ†æ²»

```ts
// åˆ†æ²»
/*
 * @param {number[]} arr
 * @param {number} k
 * @returns {number[]}
 */
function topK(arr, k) {
  if (!arr.length) return []

  let result = []
  let i = 1

  const divideAndConquer = function (arr, base, k) {
    console.log(arr)
    if (arr.length === 1) {
      return arr[0]
    }

    const max = []
    const min = []
    let maxLen = 0
    const referenceValue = arr[0]

    for (let i = 1; i < arr.length; i += 1) {
      if (arr[i] > referenceValue) {
        max.push(arr[i])
      } else {
        min.push(arr[i])
      }
    }
    max.push(referenceValue)

    maxLen = max.length + base

    if (maxLen >= k && max.length) {
      return divideAndConquer(max, base, k)
    } else if (maxLen < k && min.length) {
      return divideAndConquer(min, maxLen, k)
    }
  }

  while (i <= k && i <= arr.length) {
    result.push(divideAndConquer(arr, 0, i))
    i += 1
  }

  return result
}
```

## 153. uglify CSS class names

> https://bigfrontend.dev/zh/problem/unique-class-name

```ts
/**
 * @returns {string}
 */
function getUniqueClassName() {
  const letterSet = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z',]
  const letterSetLength = letterSet.length
  let prefix = ''
  let className = letterSet[getUniqueClassName.index]
  // æœ€åçš„è¾¹ç•Œæƒ…å†µ
  if (getUniqueClassName.prefix.length === letterSetLength) {
    return ''
  }
  for (let i = 0; i < getUniqueClassName.prefix.length; i += 1) {
    prefix += letterSet[getUniqueClassName.prefix[i]]
  }
  getUniqueClassName.index += 1
  if (getUniqueClassName.index === letterSetLength) {
    getUniqueClassName.index = 0
    if (!getUniqueClassName.prefix.length) {
      getUniqueClassName.prefix.push(0)
    } else {
      if (getUniqueClassName.prefix.every(item => item === letterSetLength - 1)) {
        getUniqueClassName.prefix = getUniqueClassName.prefix.map(() => 0)
        getUniqueClassName.prefix.push(0)
      } else {
        for (let i = getUniqueClassName.prefix.length - 1; i >= 0; i -= 1) {
          if (getUniqueClassName.prefix[i] < letterSetLength - 1) {
            getUniqueClassName.prefix[i] += 1
            break
          }
        }
      }
    }
  }
  return prefix + className;
}

getUniqueClassName.reset = function () {
  getUniqueClassName.prefix = []
  getUniqueClassName.index = 0
}

// å‰ç¼€çš„é•¿åº¦
getUniqueClassName.prefix = []
getUniqueClassName.index = 0
```

## 155. è¯·å®ç°ä¸€ä¸ªcountå‡½æ•°

> https://bigfrontend.dev/zh/problem/count-function

```ts
function count() {
  count.count += 1
  return count.count
}

count.reset = function () {
  count.count = 0
}

count.count = 0
```

## 156. è¯·å®ç°`_.set()`

> https://bigfrontend.dev/zh/problem/lodash-set

```ts
function set(obj, path, value) {
  // å­—ç¬¦ä¸²è·¯å¾„å’Œæ•°ç»„è·¯å¾„ç»Ÿä¸€å˜ä¸ºæ•°ç»„è·¯å¾„
  if (typeof path === 'string') {
    path = path.split('.')
  }

  const newPath = []
  const reg = /^([A-Za-z]+)\[([0-9]+)]$/g
  let current = obj
  let laskKey = ''

  const isNumberKey = function (key) {
    // æ˜¯å¦æ˜¯æ•°å­—çš„key
    const isNumberKey = !isNaN(Number(key))
    // æ˜¯å¦ä¸ºæ— æ•ˆçš„æ•°å­—keyï¼Œ1 æœ‰æ•ˆçš„ï¼Œ01 æ— æ•ˆçš„
    return isNumberKey && (Number(key) + '' === key) 
  }

  for (let i = 0; i < path.length; i += 1) {
    if (path[i].includes('[')) {
      const arr = reg.exec(path[i])
      newPath.push(arr[1])
      newPath.push(arr[2])
    } else {
      newPath.push(path[i])
    }
  }

  laskKey = newPath[newPath.length - 1]

  for (let i = 0; i < newPath.length - 1; i += 1) {
    const key = newPath[i]
    const nextKey = newPath[i + 1]
    const v = current[key]
    if (v instanceof Object) {
      current = v
    } else {
      if (isNumberKey(nextKey)) {
        current[key] = []
      } else {
        current[key] = {}
      }
      current = current[key]
    }
  }

  current[laskKey] = value

  return obj
}
```

## 157. semver æ¯”è¾ƒ

> https://bigfrontend.dev/zh/problem/semver-compare

> ç‰ˆæœ¬æ¯”è¾ƒ

```ts
/**
 * @param {string} v1
 * @param {string} v2
 * @returns 0 | 1 | -1
 */
function compare(v1, v2) {
  let result = 0
  const reg = /([0-9]+)\.([0-9]+)\.([0-9]+)/
  const v1Arr = []
  const v2Arr = []
  for (let i = 1; i <= 3; i += 1) {
    v1Arr.push(Number(reg.exec(v1)[i]))
    v2Arr.push(Number(reg.exec(v2)[i]))
  }
  for (let i = 0; i < v1Arr.length; i += 1) {
    if (v1Arr[i] > v2Arr[i]) {
      result = 1
      break
    } else if (v1Arr[i] < v2Arr[i]) {
      result = -1
      break
    }
  }
  return result
}
```

## 158. è¿”å›DOM treeä¸­â€å·¦è¾¹â€œçš„å…ƒç´ 

> https://bigfrontend.dev/zh/problem/previous-left-sibling

> BFSéå†å³å¯

```ts
/**
 * @param {Element} root
 * @param {Element} target
 * @return {Elemnt | null}
 */
function previousLeftSibling(root, target) {
  let result = null

  const bfs = (nodes) => {
    if (nodes.length) {
      let childrenArr = []
      let index = null
      for (let i = 0; i < nodes.length; i += 1) {
        const children = [...nodes[i].children]
        childrenArr = [...childrenArr, ...children]
      }
      for (let i = 0; i < childrenArr.length; i += 1) {
        if (childrenArr[i] === target) {
          index = i - 1
          if (index !== -1) {
            result = childrenArr[index]
          }
        }
      }
      if (index === null) {
        bfs(childrenArr)
      }
    }
  }

  bfs([root])

  return result
}
```

## 159. å®ç°promisify()

> https://bigfrontend.dev/zh/problem/promisify

> callbackæ˜¯æœ€åä¸€ä¸ªå‚æ•°

```ts
/**
 * @param {(...args) => void} func
 * @returns {(...args) => Promise<any}
 */
function promisify(func) {
  return function(...args) {
    const that = this
    return new Promise(function(resolve, reject) {
      func.apply(that, [...args, function (error, data) {
        if (error) {
          reject(error)
        } else {
          resolve(data)
        }
      }])
    })
  }
}
```

## 162. è¯·æ‰¾åˆ°æœªé‡å¤å‡ºç°çš„æ•´æ•°

> https://bigfrontend.dev/zh/problem/find-the-single-integer

> åˆ©ç”¨ä½è¿ç®—ç¬¦

```ts
/**
 * @param {number[]} arr
 * @returns number
 */
function findSingle(arr) {
  let result = arr[0]
  for (let i = 1; i < arr.length; i += 1) {
    result = result ^ arr[i]
  }
  return result
}
```

## ğŸœèš‚èšé‡‘æœé¢è¯•çœŸé¢˜: å®ç°compose

```js
function f(next) {console.log(1);next();console.log(2);}
function g(next) {console.log(3);next();console.log(4);}
function h(next) {console.log(5);next();console.log(6);}


// å®ç°compose
function compose(...funcs) {
  if (funcs.length === 0) {
    return arg => arg 
  }
  if (funcs.length === 1) {
    return funcs[0]
  }
  return function () {
    return funcs.reduce((a,b) => {
      return (next) => a(() => {
        b(next)
      })
    })(() => {})
  }
}

// 1,3,5,6,4,2
// ç¬¬ä¸€æ¬¡è¿”å›(next) => f(() => g(next)ï¼‰
// ç¬¬äºŒæ¬¡a: (next) => f(() => g(next)ï¼‰ b: h
// ç¬¬äºŒæ¬¡è¿”å› (next) => ï¼ˆ(next) => f(() => g(next))(() => h(next))
// (next) =>f(() => g(() => h(next)))
compose(f,g,h)(() => {})
```

